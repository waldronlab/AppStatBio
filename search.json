[{"path":[]},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"welcome","dir":"Articles","previous_headings":"Front matter","what":"Welcome","title":"Applied Statistics for High-throughput Biology: Session 1","text":"research interests: High-dimensional statistics (variables observations) Predictive modeling methodology validation Metagenomic profiling human microbiome Multi-omic data analysis cancer https://www.waldronlab.io","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"the-textbooks","dir":"Articles","previous_headings":"Front matter","what":"The textbooks","title":"Applied Statistics for High-throughput Biology: Session 1","text":"Biomedical Data Science Irizarry Love (ePub version Leanpub) Source repository Modern Statistics Modern Biology Holmes Huber (secondary) Orchestrating Single-Cell Analysis Bioconductor (OSCA) Amezquita, Lun, Hicks, Gottardo, O’Callaghan Biomedical Data Science book cover","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"day-1-outline","dir":"Articles","previous_headings":"Front matter","what":"Day 1 outline","title":"Applied Statistics for High-throughput Biology: Session 1","text":"Random variables distributions Hypothesis testing one two samples (t-test, Wilcoxon test, etc) Confidence intervals Essential data classes R/Bioconductor Book chapters 0 1","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"learning-objectives","dir":"Articles","previous_headings":"Front matter","what":"Learning objectives","title":"Applied Statistics for High-throughput Biology: Session 1","text":"Define random variables distinguish non-random ones Distinguish population sampling distributions Identify scenarios use z-test t-tests Interpret confidence intervals Standard Error Identify interrogate key R/Bioconductor data classes","code":""},{"path":[]},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"random-variables","dir":"Articles","previous_headings":"Random Variables and Distributions","what":"Random Variables","title":"Applied Statistics for High-throughput Biology: Session 1","text":"random variable: characteristic can measured categorized, particular outcome determined least partially chance. Examples: number new diabetes cases population given year weight randomly selected individual population Types: Categorical random variable (e.g. disease / healthy) Discrete random variable (e.g. sequence read counts) Continuous random variable (e.g. normalized qPCR intensity)","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"random-variables---examples","dir":"Articles","previous_headings":"Random Variables and Distributions","what":"Random Variables - examples","title":"Applied Statistics for High-throughput Biology: Session 1","text":"Normally distributed random variable mean \\(\\mu = 0\\) / standard deviation \\(\\sigma = 1\\), sample \\(n=100\\)","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"random-variables---examples-1","dir":"Articles","previous_headings":"Random Variables and Distributions","what":"Random Variables - examples","title":"Applied Statistics for High-throughput Biology: Session 1","text":"Poisson distributed random variable (\\(\\lambda = 2\\)), sample \\(n=100\\).","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"random-variables---examples-2","dir":"Articles","previous_headings":"Random Variables and Distributions","what":"Random Variables - examples","title":"Applied Statistics for High-throughput Biology: Session 1","text":"Negative Binomially distributed random variable (\\(size=30, \\mu=2\\)), sample \\(n=100\\).","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"random-variables---examples-3","dir":"Articles","previous_headings":"Random Variables and Distributions","what":"Random Variables - examples","title":"Applied Statistics for High-throughput Biology: Session 1","text":"use binary outcomes","code":""},{"path":[]},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"why-hypothesis-testing","dir":"Articles","previous_headings":"Hypothesis Testing","what":"Why hypothesis testing?","title":"Applied Statistics for High-throughput Biology: Session 1","text":"population mean hypothesized value, intervention causes measurable effect relative control group gene differentially expressed two populations? hypertensive, smoking men mean cholesterol level general population? confidence intervals posterior probabilities (Bayesian statistics) read p-values just tip iceberg","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"logic-of-hypothesis-testing","dir":"Articles","previous_headings":"Hypothesis Testing","what":"Logic of hypothesis testing","title":"Applied Statistics for High-throughput Biology: Session 1","text":"Hypotheses made populations based inference samples make inference samples usually observe entire population Sample vs Population Source: https://keydifferences.com/wp-content/uploads/2016/06/population-vs-sample2.jpg","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"one-and-two-sample-hypothesis-tests-of-mean","dir":"Articles","previous_headings":"Hypothesis Testing","what":"One and two-sample hypothesis tests of mean","title":"Applied Statistics for High-throughput Biology: Session 1","text":"One-sample hypothesis test mean - sample comes one two population distributions: \\(H_0: \\mu = \\mu_0\\) (null hypothesis) \\(H_A: \\mu \\neq \\mu_0\\) (alternative hypothesis) Two-sample hypothesis test means - two samples drawn, either: \\(H_0: \\mu_1 = \\mu_2\\) (null hypothesis) \\(H_A: \\mu_1 \\neq \\mu_2\\) (alternative hypothesis)","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"population-vs-sampling-distributions","dir":"Articles","previous_headings":"Hypothesis Testing","what":"Population vs sampling distributions","title":"Applied Statistics for High-throughput Biology: Session 1","text":"realization / point individual realization / point sample distribution depends sample size large sample distributions given Central Limit Theorem sample likely come distribution?","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"note-about-the-central-limit-theorem","dir":"Articles","previous_headings":"Hypothesis Testing","what":"Note about the Central Limit Theorem","title":"Applied Statistics for High-throughput Biology: Session 1","text":"sample size large, average \\(\\bar{Y}\\) random sample: Follows normal distribution normal distribution mean entered population average \\(\\mu_Y\\) standard deviation equal population standard deviation \\(\\sigma_Y\\), divided square root sample size \\(N\\). refer standard deviation distribution random variable random variable’s standard error. Thanks CLT, linear modeling, t-tests, ANOVA guaranteed work reasonably well large samples (~30 observations). Go online demo: http://onlinestatbook.com/stat_sim/sampling_dist/","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"example-applications-of-hypothesis-tests-for-continuous-variables","dir":"Articles","previous_headings":"Hypothesis Testing","what":"Example applications of hypothesis tests for continuous variables","title":"Applied Statistics for High-throughput Biology: Session 1","text":"study participants diet lose weight compared control group? gene knockout result less viable cell colonies, measured number living cells replicate experiments? Prevotella copri abundant guts vegans meat-eaters? infants born region higher birthweight national average? research hypotheses. corresponding null hypotheses?","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"the-z-tests","dir":"Articles","previous_headings":"Hypothesis Testing","what":"The z-tests","title":"Applied Statistics for High-throughput Biology: Session 1","text":"“\\(z\\)” refers Standard Normal Distribution: \\(N(\\mu=0, \\sigma=1)\\) \\(H_0: \\mu = \\mu_0\\) \\(H_0: \\mu_1 = \\mu_2\\) \\(H_0: \\mu_{} = \\mu_{}\\) \\(H_0: \\mu_{upper} = \\mu_{lower}\\)","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"when-to-use-z-tests","dir":"Articles","previous_headings":"Hypothesis Testing","what":"When to use z-tests","title":"Applied Statistics for High-throughput Biology: Session 1","text":"standard deviation \\(\\sigma\\) population known advance population values normally distributed population values slightly skewed n > 15 population values quite skewed n > 30","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"example-of-one-sample-z-test","dir":"Articles","previous_headings":"Hypothesis Testing","what":"Example of one-sample z-test","title":"Applied Statistics for High-throughput Biology: Session 1","text":"","code":"library(TeachingDemos) set.seed(1) (weights = rnorm(10, mean = 75, sd = 10)) #>  [1] 68.73546 76.83643 66.64371 90.95281 78.29508 66.79532 79.87429 82.38325 #>  [9] 80.75781 71.94612 TeachingDemos::z.test(     x = weights,     mu = 70,  #specified for population under H0 because this is a one-sample test     stdev = 10, #specified for population because this is a z-test     alternative = \"two.sided\" ) #>  #>  One Sample z-test #>  #> data:  weights #> z = 1.9992, n = 10.0000, Std. Dev. = 10.0000, Std. Dev. of the sample #> mean = 3.1623, p-value = 0.04559 #> alternative hypothesis: true mean is not equal to 70 #> 95 percent confidence interval: #>  70.12408 82.51998 #> sample estimates: #> mean of weights  #>        76.32203"},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"the-t-tests","dir":"Articles","previous_headings":"Hypothesis Testing","what":"The t-tests","title":"Applied Statistics for High-throughput Biology: Session 1","text":"t-tests small samples rely Central Limit Theorem \\(H_0: \\mu = \\mu_0\\) \\(H_0: \\mu_1 = \\mu_2\\) individuals treatment","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"when-to-use-t-tests","dir":"Articles","previous_headings":"Hypothesis Testing","what":"When to use t-tests","title":"Applied Statistics for High-throughput Biology: Session 1","text":"standard deviation \\(s\\) estimated sample population values normally distributed population values slightly skewed n > 15 population values quite skewed n > 30 e.g. rank data data ranks informative means many ranks arbitrary","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"example-of-one-sample-t-test","dir":"Articles","previous_headings":"Hypothesis Testing","what":"Example of one-sample t-test","title":"Applied Statistics for High-throughput Biology: Session 1","text":"Note specify standard deviation, estimated sample. particular example p-value smaller z-test, general less powerful z-test assumptions met.","code":"stats::t.test(     x = weights,     mu = 70,  #specified for population under H0 because this is a one-sample test     alternative = \"two.sided\" ) #>  #>  One Sample t-test #>  #> data:  weights #> t = 2.5612, df = 9, p-value = 0.03063 #> alternative hypothesis: true mean is not equal to 70 #> 95 percent confidence interval: #>  70.73805 81.90600 #> sample estimates: #> mean of x  #>  76.32203"},{"path":[]},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"why-confidence-intervals","dir":"Articles","previous_headings":"Confidence intervals","what":"Why confidence intervals?","title":"Applied Statistics for High-throughput Biology: Session 1","text":"procedures produced p-values confidence intervals p-values useful deciding whether reject \\(H_0\\) p-values report effect size (observed difference). p-values indicate statistical significance guarantee scientific/clinical significance. Confidence intervals provide probable range true population mean.","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"intervals-for-any-confidence-level","dir":"Articles","previous_headings":"Confidence intervals","what":"Intervals for any confidence level","title":"Applied Statistics for High-throughput Biology: Session 1","text":"\\(\\bar{X} \\pm 1.96 \\times SE\\) (95% CI, normal sampling distribution) \\(\\bar{X} \\pm z_{\\alpha / 2}^{crit} \\times SE\\) (normal sampling distribution) \\(\\bar{X} \\pm t_{\\alpha / 2, df}^{crit} \\times SE\\) (t sampling distribution) part \\(\\pm\\) called margin error","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"confidence-intervals-vs--hypothesis-testing","dir":"Articles","previous_headings":"Confidence intervals","what":"Confidence intervals vs. hypothesis testing","title":"Applied Statistics for High-throughput Biology: Session 1","text":"reject \\(H_0\\) “null value” contained CI two sample hypothesis test \\(H_0: \\mu_1 = \\mu_2\\), must construct single confidence interval \\(\\mu_1 - \\mu_2\\)","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"q-a-confidence-intervals","dir":"Articles","previous_headings":"Confidence intervals","what":"Q & A: confidence intervals","title":"Applied Statistics for High-throughput Biology: Session 1","text":"following true? 95% CI contains 95% values population 95% CI contain population mean, 19 times 20 95% CI 95% probable contain population mean 99% CI wider 95% CI","code":""},{"path":[]},{"path":[]},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"use-and-mis-use-of-the-p-value","dir":"Articles","previous_headings":"Summary - hypothesis testing","what":"Use and mis-use of the p-value","title":"Applied Statistics for High-throughput Biology: Session 1","text":"p-value probability observing sample statistic extreme , assuming \\(H_0\\) true don’t treat precise. don’t silly things like try interpret differences ratios p-values don’t lose track test assumptions independence observations use moderate p-value cutoff, use effect size measure ranking variable repeated sampling, sensitive test assumptions","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"use-and-mis-use-of-the-p-value-contd","dir":"Articles","previous_headings":"Summary - hypothesis testing","what":"Use and mis-use of the p-value (cont’d)","title":"Applied Statistics for High-throughput Biology: Session 1","text":"Failing reject \\(H_0\\) mean \\(H_0\\) true “evidence difference \\(\\neq\\) evidence difference” sample size increases, point estimates mean precise large sample size, small differences means may statistically significant practically significant Although \\(\\alpha = 0.05\\) common cut-p-value, set border “significant” “insignificant,” increasingly strong evidence \\(H_0\\) (favor \\(H_A\\)) p-value gets smaller.","code":""},{"path":[]},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"tips-for-learning-r","dir":"Articles","previous_headings":"R - basic usage","what":"Tips for learning R","title":"Applied Statistics for High-throughput Biology: Session 1","text":"Slide credit: Marcel Ramos","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"installing-packages-the-bioconductor-way","dir":"Articles","previous_headings":"R - basic usage","what":"Installing Packages the Bioconductor Way","title":"Applied Statistics for High-throughput Biology: Session 1","text":"See Bioconductor site info Pseudo code: Works CRAN, GitHub, Bioconductor packages!","code":"install.packages(\"BiocManager\") #from CRAN packages <- c(\"packagename\", \"githubuser/repository\", \"biopackage\") BiocManager::install(packages) BiocManager::valid()  #check validity of installed packages"},{"path":[]},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"base-r-data-types-atomic-vectors","dir":"Articles","previous_headings":"Introduction to the R/Bioconductor data classes","what":"Base R Data Types: atomic vectors","title":"Applied Statistics for High-throughput Biology: Session 1","text":"numeric (set seed sync random number generator): integer: logical: character: factor: real-life recoding factors, try dplyr::recode, dplyr::recode_factor","code":"set.seed(1) rnorm(5) #> [1] -0.6264538  0.1836433 -0.8356286  1.5952808  0.3295078 sample(1L:5L) #> [1] 3 5 1 4 2 1:3 %in% 3 #> [1] FALSE FALSE  TRUE c(\"yes\", \"no\") #> [1] \"yes\" \"no\" factor(c(\"yes\", \"no\")) #> [1] yes no  #> Levels: no yes"},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"base-r-data-types-missingness","dir":"Articles","previous_headings":"Introduction to the R/Bioconductor data classes","what":"Base R Data Types: missingness","title":"Applied Statistics for High-throughput Biology: Session 1","text":"Missing Values others - IMPORTANT class() find class variable.","code":"c(NA, NaN, -Inf, Inf) #> [1]   NA  NaN -Inf  Inf"},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"base-r-data-types-matrix-list-data-frame","dir":"Articles","previous_headings":"Introduction to the R/Bioconductor data classes","what":"Base R Data Types: matrix, list, data.frame","title":"Applied Statistics for High-throughput Biology: Session 1","text":"matrix: list non-atomic vector: data.frame list-like matrix-like properties:","code":"matrix(1:9, nrow = 3) #>      [,1] [,2] [,3] #> [1,]    1    4    7 #> [2,]    2    5    8 #> [3,]    3    6    9 measurements <- c(1.3, 1.6, 3.2, 9.8, 10.2) parents <- c(\"Parent1.name\", \"Parent2.name\") my.list <- list(measurements, parents) my.list #> [[1]] #> [1]  1.3  1.6  3.2  9.8 10.2 #>  #> [[2]] #> [1] \"Parent1.name\" \"Parent2.name\" x <- 11:16 y <- seq(0, 1, .2) z <- c(\"one\", \"two\", \"three\", \"four\", \"five\", \"six\") a <- factor(z) my.df <- data.frame(x, y, z, a, stringsAsFactors = FALSE)"},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"bioconductor-s4-vectors-dataframe","dir":"Articles","previous_headings":"Introduction to the R/Bioconductor data classes","what":"Bioconductor S4 vectors: DataFrame","title":"Applied Statistics for High-throughput Biology: Session 1","text":"GenomicRanges objects Rle (run-length encoding)","code":"suppressPackageStartupMessages(library(S4Vectors)) df <- DataFrame(var1 = Rle(c(\"a\", \"a\", \"b\")),                 var2 = 1:3) metadata(df) <- list(parent = \"DataFrame is my virtual parent\") df #> DataFrame with 3 rows and 2 columns #>    var1      var2 #>   <Rle> <integer> #> 1     a         1 #> 2     a         2 #> 3     b         3"},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"dataframe-is-actually-a-virtual-classes","dir":"Articles","previous_headings":"Introduction to the R/Bioconductor data classes","what":"DataFrame is actually a virtual classes","title":"Applied Statistics for High-throughput Biology: Session 1","text":"Rationale: Methods defined DFrame shared classes inheriting See: https://bioconductor.org/help/course-materials/2019/BiocDevelForum/02-DataFrame.pdf See also: https://github.com/Bioconductor/S4Vectors/issues/90#issue-1026425148","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"list-and-derived-classes","dir":"Articles","previous_headings":"Introduction to the R/Bioconductor data classes","what":"List and derived classes","title":"Applied Statistics for High-throughput Biology: Session 1","text":"","code":"List(my.list) #> List of length 2 str(List(my.list)) #> Formal class 'SimpleList' [package \"S4Vectors\"] with 4 slots #>   ..@ listData       :List of 2 #>   .. ..$ : num [1:5] 1.3 1.6 3.2 9.8 10.2 #>   .. ..$ : chr [1:2] \"Parent1.name\" \"Parent2.name\" #>   ..@ elementType    : chr \"ANY\" #>   ..@ elementMetadata: NULL #>   ..@ metadata       : list() suppressPackageStartupMessages(library(IRanges)) IntegerList(var1 = 1:26, var2 = 1:100) #> IntegerList of length 2 #> [[\"var1\"]] 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 #> [[\"var2\"]] 1 2 3 4 5 6 7 8 9 10 11 12 ... 89 90 91 92 93 94 95 96 97 98 99 100 CharacterList(var1 = letters[1:100], var2 = LETTERS[1:26]) #> CharacterList of length 2 #> [[\"var1\"]] a b c d e f g h i j ... <NA> <NA> <NA> <NA> <NA> <NA> <NA> <NA> <NA> #> [[\"var2\"]] A B C D E F G H I J K L M N O P Q R S T U V W X Y Z LogicalList(var1 = 1:100 %in% 5, var2 = 1:100 %% 2) #> LogicalList of length 2 #> [[\"var1\"]] FALSE FALSE FALSE FALSE TRUE FALSE ... FALSE FALSE FALSE FALSE FALSE #> [[\"var2\"]] TRUE FALSE TRUE FALSE TRUE FALSE ... FALSE TRUE FALSE TRUE FALSE"},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"biostrings","dir":"Articles","previous_headings":"Introduction to the R/Bioconductor data classes","what":"Biostrings","title":"Applied Statistics for High-throughput Biology: Session 1","text":"","code":"suppressPackageStartupMessages(library(Biostrings)) bstring <- BString(\"I am a BString object\") bstring #> 21-letter BString object #> seq: I am a BString object dnastring <- DNAString(\"TTGAAA-CTC-N\") dnastring #> 12-letter DNAString object #> seq: TTGAAA-CTC-N str(dnastring) #> Formal class 'DNAString' [package \"Biostrings\"] with 5 slots #>   ..@ shared         :Formal class 'SharedRaw' [package \"XVector\"] with 2 slots #>   .. .. ..@ xp                    :<externalptr>  #>   .. .. ..@ .link_to_cached_object:<environment: 0x560dbe802cd0>  #>   ..@ offset         : int 0 #>   ..@ length         : int 12 #>   ..@ elementMetadata: NULL #>   ..@ metadata       : list() alphabetFrequency(dnastring, baseOnly=TRUE, as.prob=TRUE) #>          A          C          G          T      other  #> 0.25000000 0.16666667 0.08333333 0.25000000 0.25000000"},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"rangedsummarizedexperiment","dir":"Articles","previous_headings":"Introduction to the R/Bioconductor data classes","what":"(Ranged)SummarizedExperiment","title":"Applied Statistics for High-throughput Biology: Session 1","text":"* Source: https://bioconductor.org/packages/SummarizedExperiment/","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"rangedsummarizedexperiment-1","dir":"Articles","previous_headings":"Introduction to the R/Bioconductor data classes","what":"(Ranged)SummarizedExperiment","title":"Applied Statistics for High-throughput Biology: Session 1","text":"RangedSummarizedExperiment de facto standard “rectangular” data metadata Extended SingleCellExperiment, DESeqDataSet Emulated MultiAssayExperiment","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"lab-exercises-and-links","dir":"Articles","previous_headings":"Introduction to the R/Bioconductor data classes","what":"Lab Exercises and Links","title":"Applied Statistics for High-throughput Biology: Session 1","text":"OSCA Introduction Chapter 3: Getting scRNA-seq datasets OSCA Introduction Chapter 4: SingleCellExperiment class (time allows) built html version lecture available. source R Markdown also available Github.","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"schematic-of-a-typical-scrna-seq-analysis-workflow","dir":"Articles","previous_headings":"","what":"Schematic of a typical scRNA-seq analysis workflow","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Single-cell workflow stage (separated dashed lines) consists number specific steps, many operate modify SingleCellExperiment instance.","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"day-4-outline","dir":"Articles","previous_headings":"","what":"Day 4 outline","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Book chapter 8: Distances high dimensions Principal Components Analysis Singular Value Decomposition Multidimensional Scaling t-SNE UMAP","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"metrics-and-distances","dir":"Articles","previous_headings":"","what":"Metrics and distances","title":"Applied Statistics for High-throughput Biology: Session 2","text":"metric satisfies following five properties: non-negativity \\(d(, b) \\ge 0\\) symmetry \\(d(, b) = d(b, )\\) identification mark \\(d(, ) = 0\\) definiteness \\(d(, b) = 0\\) \\(=b\\) triangle inequality \\(d(, b) + d(b, c) \\ge d(, c)\\) distance required satisfy 1-3. similarity function satisfies 1-2, increases \\(\\) \\(b\\) become similar dissimilarity function satisfies 1-2, decreases \\(\\) \\(b\\) become similar","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"euclidian-distance-metric","dir":"Articles","previous_headings":"","what":"Euclidian distance (metric)","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Remember grade school:  Euclidean d = \\(\\sqrt{ (A_x-B_x)^2 + (A_y-B_y)^2}\\). Side note: also referred \\(L_2\\) norm","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"euclidian-distance-in-high-dimensions","dir":"Articles","previous_headings":"","what":"Euclidian distance in high dimensions","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Interested identifying similar samples similar genes","code":"## BiocManager::install(\"genomicsclass/tissuesGeneExpression\") #if needed ## BiocManager::install(\"genomicsclass/GSE5859\") #if needed library(GSE5859) library(tissuesGeneExpression) data(tissuesGeneExpression) dim(e) ##gene expression data #> [1] 22215   189 table(tissue) ##tissue[i] corresponds to e[,i] #> tissue #>  cerebellum       colon endometrium hippocampus      kidney       liver  #>          38          34          15          31          39          26  #>    placenta  #>           6"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"notes-about-euclidian-distance-in-high-dimensions","dir":"Articles","previous_headings":"","what":"Notes about Euclidian distance in high dimensions","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Points longer Cartesian plane sample \\(\\) defined point 22,215 dimensional space: \\((Y_{1,},\\dots,Y_{22215,})^\\top\\). feature \\(g\\) defined point 189 dimensions \\((Y_{g,189},\\dots,Y_{g,189})^\\top\\) Euclidean distance two dimensions. E.g., distance two samples \\(\\) \\(j\\) : \\[ \\mbox{dist}(,j) = \\sqrt{ \\sum_{g=1}^{22215} (Y_{g,}-Y_{g,j })^2 } \\] distance two features \\(h\\) \\(g\\) : \\[ \\mbox{dist}(h,g) = \\sqrt{ \\sum_{=1}^{189} (Y_{h,}-Y_{g,})^2 } \\]","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"euclidian-distance-in-matrix-algebra-notation","dir":"Articles","previous_headings":"","what":"Euclidian distance in matrix algebra notation","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Euclidian distance samples \\(\\) \\(j\\) can written : \\[ \\mbox{dist}(,j) = \\sqrt{ (\\mathbf{Y}_i - \\mathbf{Y}_j)^\\top(\\mathbf{Y}_i - \\mathbf{Y}_j) }\\] \\(\\mathbf{Y}_i\\) \\(\\mathbf{Y}_j\\) columns \\(\\) \\(j\\).","code":"t(matrix(1:3, ncol = 1)) #>      [,1] [,2] [,3] #> [1,]    1    2    3 matrix(1:3, ncol = 1) #>      [,1] #> [1,]    1 #> [2,]    2 #> [3,]    3 t(matrix(1:3, ncol = 1)) %*% matrix(1:3, ncol = 1) #>      [,1] #> [1,]   14"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"note-about-matrix-algebra-in-r","dir":"Articles","previous_headings":"","what":"Note about matrix algebra in R","title":"Applied Statistics for High-throughput Biology: Session 2","text":"R efficient matrix algebra Matrix CRAN package (sparse matrices) rhdf5 DelayedArray Bioconductor package (-disk arrays)","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"sample-example","dir":"Articles","previous_headings":"","what":"3 sample example","title":"Applied Statistics for High-throughput Biology: Session 2","text":"","code":"kidney1 <- e[, 1] kidney2 <- e[, 2] colon1 <- e[, 87] sqrt(sum((kidney1 - kidney2) ^ 2)) #> [1] 85.8546 sqrt(sum((kidney1 - colon1) ^ 2)) #> [1] 122.8919"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"sample-example-using-dist","dir":"Articles","previous_headings":"","what":"3 sample example using dist()","title":"Applied Statistics for High-throughput Biology: Session 2","text":"","code":"dim(e) #> [1] 22215   189 (d <- dist(t(e[, c(1, 2, 87)]))) #>                 GSM11805.CEL.gz GSM11814.CEL.gz #> GSM11814.CEL.gz         85.8546                 #> GSM92240.CEL.gz        122.8919        115.4773 class(d) #> [1] \"dist\""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"the-dist-function","dir":"Articles","previous_headings":"","what":"The dist() function","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Excerpt ?dist: must one “euclidean”, “maximum”, “manhattan”, “canberra”, “binary” “minkowski”. unambiguous substring can given. dist class output dist() used many clustering algorithms heatmap functions Caution: dist(e) creates 22215 x 22215 matrix probably crash R session.","code":"dist(     x,     method = \"euclidean\",     diag = FALSE,     upper = FALSE,     p = 2 )"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"note-on-standardization","dir":"Articles","previous_headings":"","what":"Note on standardization","title":"Applied Statistics for High-throughput Biology: Session 2","text":"practice, features (e.g. genes) typically “standardized”, .e. converted z-score: \\[x_{gi} \\leftarrow \\frac{(x_{gi} - \\bar{x}_g)}{s_g}\\] GC bias, PCR amplification efficiency, … \\(\\frac{d_E(x, y)^2}{2m} = 1 - r_{xy}\\) \\(m\\) = # dimensions","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"dimension-reduction-and-pca","dir":"Articles","previous_headings":"","what":"Dimension reduction and PCA","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Motivation dimension reduction Simulate heights twin pairs:","code":"set.seed(1) n <- 100 y <- t(MASS::mvrnorm(n, c(0, 0), matrix(c(1, 0.95, 0.95, 1), 2, 2))) dim(y) #> [1]   2 100 cor(t(y)) #>           [,1]      [,2] #> [1,] 1.0000000 0.9433295 #> [2,] 0.9433295 1.0000000"},{"path":[]},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"not-much-distance-is-lost-in-the-second-dimension","dir":"Articles","previous_headings":"","what":"Not much distance is lost in the second dimension","title":"Applied Statistics for High-throughput Biology: Session 2","text":"twin heights highly correlated","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"singular-value-decomposition-svd","dir":"Articles","previous_headings":"","what":"Singular Value Decomposition (SVD)","title":"Applied Statistics for High-throughput Biology: Session 2","text":"SVD generalizes example rotation looked : \\[\\mathbf{Y} = \\mathbf{UDV}^\\top\\] note: formulation \\(m\\) rows \\(> n\\) columns \\(\\mathbf{Y}\\): \\(m\\) rows x \\(n\\) cols matrix measurements \\(\\mathbf{U}\\): \\(m \\times n\\) matrix relating original scores PCA scores (loadings) \\(\\mathbf{D}\\): \\(n \\times n\\) diagonal matrix (eigenvalues) \\(\\mathbf{V}\\): \\(n \\times n\\) orthogonal matrix (eigenvectors PCA scores) orthogonal = unit length “perpendicular” 3-D","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"svd-of-gene-expression-dataset","dir":"Articles","previous_headings":"","what":"SVD of gene expression dataset","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Scaling: SVD:","code":"e.standardize <- t(scale(t(e), scale = FALSE)) s <- svd(e.standardize) names(s) #> [1] \"d\" \"u\" \"v\""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"components-of-svd-results","dir":"Articles","previous_headings":"","what":"Components of SVD results","title":"Applied Statistics for High-throughput Biology: Session 2","text":"","code":"dim(s$u)     # loadings #> [1] 22215   189 length(s$d)  # eigenvalues #> [1] 189 dim(s$v)     # d %*% vT = scores #> [1] 189 189"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"pca-is-a-svd","dir":"Articles","previous_headings":"","what":"PCA is a SVD","title":"Applied Statistics for High-throughput Biology: Session 2","text":"gene expression dataset  Lesson: u v can multiplied -1 arbitrarily","code":"rafalib::mypar() p <- prcomp(t(e.standardize)) plot(s$u[, 1] ~ p$rotation[, 1])"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"pca-interpretation-loadings","dir":"Articles","previous_headings":"","what":"PCA interpretation: loadings","title":"Applied Statistics for High-throughput Biology: Session 2","text":"think principal component axes weighted combination original axes","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"visualizing-pca-loadings","dir":"Articles","previous_headings":"","what":"Visualizing PCA loadings","title":"Applied Statistics for High-throughput Biology: Session 2","text":"","code":"plot(p$rotation[, 1],      xlab = \"Index of genes\",      ylab = \"Loadings of PC1\",      main = \"PC1 loadings of each gene\") #or, predict(p) abline(h = c(-0.03, 0.03), col = \"red\")"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"genes-with-high-pc1-loadings","dir":"Articles","previous_headings":"","what":"Genes with high PC1 loadings","title":"Applied Statistics for High-throughput Biology: Session 2","text":"","code":"e.pc1genes <-     e.standardize[p$rotation[, 1] < -0.03 |                            p$rotation[, 1] > 0.03,] pheatmap::pheatmap(     e.pc1genes,     scale = \"none\",     show_rownames = TRUE,     show_colnames = FALSE )"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"pca-interpretation-eigenvalues","dir":"Articles","previous_headings":"","what":"PCA interpretation: eigenvalues","title":"Applied Statistics for High-throughput Biology: Session 2","text":"\\(\\mathbf{D}\\) (eigenvalues): standard deviation scaling factor decomposed variable multiplied .","code":"rafalib::mypar() plot(     p$sdev ^ 2 / sum(p$sdev ^ 2) * 100,     xlim = c(0, 150),     type = \"b\",     ylab = \"% variance explained\",     main = \"Screeplot\" )"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"pca-interpretation-eigenvalues-1","dir":"Articles","previous_headings":"","what":"PCA interpretation: eigenvalues","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Alternatively cumulative % variance explained (using cumsum() function)","code":"rafalib::mypar() plot(     cumsum(p$sdev ^ 2) / sum(p$sdev ^ 2) * 100,     ylab = \"cumulative % variance explained\",     ylim = c(0, 100),     type = \"b\",     main = \"Cumulative screeplot\" )"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"pca-interpretation-scores","dir":"Articles","previous_headings":"","what":"PCA interpretation: scores","title":"Applied Statistics for High-throughput Biology: Session 2","text":"\\(\\mathbf{V}\\) (scores): “datapoints” reduced prinipal component space implementations (like prcomp()), scores already scaled eigenvalues: \\(\\mathbf{D V^T}\\)","code":""},{"path":[]},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"multi-dimensional-scaling-mds","dir":"Articles","previous_headings":"","what":"Multi-dimensional Scaling (MDS)","title":"Applied Statistics for High-throughput Biology: Session 2","text":"also referred Principal Coordinates Analysis (PCoA) reduced SVD, performed distance matrix identify two () eigenvalues/vectors preserve distances","code":"d <- as.dist(1 - cor(e.standardize)) mds <- cmdscale(d)"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"t-sne","dir":"Articles","previous_headings":"","what":"t-SNE","title":"Applied Statistics for High-throughput Biology: Session 2","text":"almost magical ability show clearly separated clusters performs different transformations different regions computationally intensive usually done top ~30 PCs “perplexity” parameter defines (loosely) balance attention local global aspects data optimal choice perplexity changes different numbers cells sample. perplexity = \\(\\sqrt{N}\\) one rule thumb. \\(max(N/5, 50)\\) another (default Rtsne) good post Nikolay Oskolkov topic.","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"t-sne-caveats","dir":"Articles","previous_headings":"","what":"t-SNE caveats","title":"Applied Statistics for High-throughput Biology: Session 2","text":"uses random number generator apparent spread clusters completely meaningless distance clusters might also mean anything parameters can tuned make data appear want can show apparent clusters random noise. used statistical inference Try gain intuition: https://distill.pub/2016/misread-tsne/) tSNE","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"pca-of-zeisel-single-cell-rna-seq-dataset","dir":"Articles","previous_headings":"","what":"PCA of Zeisel single-cell RNA-seq dataset","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Principal Components Analysis Zeisel dataset","code":"sce.zeisel <- fixedPCA(sce.zeisel, subset.row=NULL) plotReducedDim(sce.zeisel, dimred=\"PCA\", colour_by=\"level1class\")"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"t-sne-of-the-same-dataset","dir":"Articles","previous_headings":"","what":"t-SNE of the same dataset","title":"Applied Statistics for High-throughput Biology: Session 2","text":"t-SNE clustering Zeisel dataset","code":"sce.zeisel <- runTSNE(sce.zeisel, dimred=\"PCA\") plotReducedDim(sce.zeisel, dimred=\"TSNE\", colour_by=\"level1class\")"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"umap-vs-t-sne","dir":"Articles","previous_headings":"","what":"UMAP vs t-SNE","title":"Applied Statistics for High-throughput Biology: Session 2","text":"UMAP may better preserve local global distances tends compact visual clusters empty space computationally efficient also involves random number generation Note: prefer setting random number seed exploratory analysis order see random variability","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"umap-of-the-same-dataset","dir":"Articles","previous_headings":"","what":"UMAP of the same dataset","title":"Applied Statistics for High-throughput Biology: Session 2","text":"UMAP representation Zeisel dataset","code":"sce.zeisel <- runUMAP(sce.zeisel, dimred=\"PCA\") plotReducedDim(sce.zeisel, dimred=\"UMAP\", colour_by=\"level1class\")"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"summary-distances-and-dimension-reduction","dir":"Articles","previous_headings":"","what":"Summary: distances and dimension reduction","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Note: signs eigenvalues (square get variances) eigenvectors (loadings) can arbitrarily flipped PCA MDS useful dimension reduction correlated variables Variables always centered. Variables also scaled unless know scale population PCA projection can applied new datasets know matrix calculations PCA subject -fitting, screeplot can tested cross-validation PCA often used prior t-SNE UMAP de-noising computational tractability","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"lab-exercise","dir":"Articles","previous_headings":"","what":"Lab exercise","title":"Applied Statistics for High-throughput Biology: Session 2","text":"OSCA Basics: Chapter 4 Dimensionality Reduction Optional interested, OSCA Advanced: Chapter 4 Dimensionality reduction, redux","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"links","dir":"Articles","previous_headings":"","what":"Links","title":"Applied Statistics for High-throughput Biology: Session 2","text":"built html version lecture available. source R Markdown also available Github.","code":""},{"path":"http://waldronlab.io/AppStatBio/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Levi Waldron. Author, maintainer.","code":""},{"path":"http://waldronlab.io/AppStatBio/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Waldron L (2023). AppStatBio: Course Materials Applied Statistics High-throughput Biology. R package version 0.0.0.9000, http://waldronlab.io/AppStatBio/.","code":"@Manual{,   title = {AppStatBio: Course Materials for Applied Statistics for High-throughput Biology},   author = {Levi Waldron},   year = {2023},   note = {R package version 0.0.0.9000},   url = {http://waldronlab.io/AppStatBio/}, }"},{"path":[]},{"path":"http://waldronlab.io/AppStatBio/index.html","id":"instructor","dir":"","previous_headings":"","what":"Instructor","title":"Course Materials for Applied Statistics for High-throughput Biology","text":"Levi Waldron, PhD Associate Professor Biostatistics City University New York School Graduate Public Health Health Policy New York, NY, U.S.. Email: lwaldron.research@gmail.com contact information: https://waldronlab.io","code":""},{"path":"http://waldronlab.io/AppStatBio/index.html","id":"summary","dir":"","previous_headings":"","what":"Summary","title":"Course Materials for Applied Statistics for High-throughput Biology","text":"course provide biologists bioinformaticians practical statistical data analysis skills perform rigorous analysis high-throughput biological data. course assumes familiarity genomics R programming, assume prior statistical training. covers statistical concepts necessary design experiments analyze high-dimensional data generated genomic technologies, including: exploratory data analysis, linear modeling, analysis categorical variables, principal components analysis, batch effects.","code":""},{"path":"http://waldronlab.io/AppStatBio/index.html","id":"textbook","dir":"","previous_headings":"","what":"Textbook","title":"Course Materials for Applied Statistics for High-throughput Biology","text":"Biomedical Data Science Irizarry Love (ePub version Leanpub) Source repository Modern Statistics Modern Biology Holmes Huber (secondary) Orchestrating Single-Cell Analysis Bioconductor (OSCA) Amezquita, Lun, Hicks, Gottardo, O’Callaghan","code":""},{"path":"http://waldronlab.io/AppStatBio/index.html","id":"related-resources","dir":"","previous_headings":"","what":"Related Resources","title":"Course Materials for Applied Statistics for High-throughput Biology","text":"http://waldronlab.io/teaching/resources/","code":""},{"path":"http://waldronlab.io/AppStatBio/index.html","id":"labs","dir":"","previous_headings":"","what":"Labs","title":"Course Materials for Applied Statistics for High-throughput Biology","text":"day include hands-lab session, students attempt full.","code":""},{"path":"http://waldronlab.io/AppStatBio/index.html","id":"session-detail-by-day","dir":"","previous_headings":"","what":"Session detail by day","title":"Course Materials for Applied Statistics for High-throughput Biology","text":"course materials available https://github.com/waldronlab/AppStatBio/. random variables distributions hypothesis testing one two samples (t-test, Wilcoxon test, etc) Distances high dimensions Principal Components Analysis Singular Value Decomposition Multidimensional Scaling t-SNE UMAP","code":""}]
