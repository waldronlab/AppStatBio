[{"path":[]},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"welcome","dir":"Articles","previous_headings":"Front matter","what":"Welcome","title":"Applied Statistics for High-throughput Biology: Session 1","text":"research interests: High-dimensional statistics (variables observations) Predictive modeling methodology validation Metagenomic profiling human microbiome Multi-omic data analysis cancer https://www.waldronlab.io","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"the-textbooks","dir":"Articles","previous_headings":"Front matter","what":"The textbooks","title":"Applied Statistics for High-throughput Biology: Session 1","text":"Biomedical Data Science Irizarry Love (ePub version Leanpub) Source repository Modern Statistics Modern Biology Holmes Huber (secondary) Orchestrating Single-Cell Analysis Bioconductor (OSCA) Amezquita, Lun, Hicks, Gottardo, O’Callaghan Biomedical Data Science book cover","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"day-1-outline","dir":"Articles","previous_headings":"Front matter","what":"Day 1 outline","title":"Applied Statistics for High-throughput Biology: Session 1","text":"Random variables distributions Hypothesis testing one two samples (t-test, Wilcoxon test, etc) Confidence intervals Essential data classes R/Bioconductor Book chapters 0 1","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"learning-objectives","dir":"Articles","previous_headings":"Front matter","what":"Learning objectives","title":"Applied Statistics for High-throughput Biology: Session 1","text":"Define random variables distinguish non-random ones Distinguish population sampling distributions Identify scenarios use z-test t-tests Interpret confidence intervals Standard Error Identify interrogate key R/Bioconductor data classes","code":""},{"path":[]},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"random-variables","dir":"Articles","previous_headings":"Random Variables and Distributions","what":"Random Variables","title":"Applied Statistics for High-throughput Biology: Session 1","text":"random variable: characteristic can measured categorized, particular outcome determined least partially chance. Examples: number new diabetes cases population given year weight randomly selected individual population Types: Categorical random variable (e.g. disease / healthy) Discrete random variable (e.g. sequence read counts) Continuous random variable (e.g. normalized qPCR intensity)","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"random-variables---examples","dir":"Articles","previous_headings":"Random Variables and Distributions","what":"Random Variables - examples","title":"Applied Statistics for High-throughput Biology: Session 1","text":"Normally distributed random variable mean \\(\\mu = 0\\) / standard deviation \\(\\sigma = 1\\), sample \\(n=100\\)","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"random-variables---examples-1","dir":"Articles","previous_headings":"Random Variables and Distributions","what":"Random Variables - examples","title":"Applied Statistics for High-throughput Biology: Session 1","text":"Poisson distributed random variable (\\(\\lambda = 2\\)), sample \\(n=100\\).","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"random-variables---examples-2","dir":"Articles","previous_headings":"Random Variables and Distributions","what":"Random Variables - examples","title":"Applied Statistics for High-throughput Biology: Session 1","text":"Negative Binomially distributed random variable (\\(size=30, \\mu=2\\)), sample \\(n=100\\).","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"random-variables---examples-3","dir":"Articles","previous_headings":"Random Variables and Distributions","what":"Random Variables - examples","title":"Applied Statistics for High-throughput Biology: Session 1","text":"use binary outcomes","code":""},{"path":[]},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"why-hypothesis-testing","dir":"Articles","previous_headings":"Hypothesis Testing","what":"Why hypothesis testing?","title":"Applied Statistics for High-throughput Biology: Session 1","text":"population mean hypothesized value, intervention causes measurable effect relative control group gene differentially expressed two populations? hypertensive, smoking men mean cholesterol level general population? confidence intervals posterior probabilities (Bayesian statistics) read p-values just tip iceberg","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"logic-of-hypothesis-testing","dir":"Articles","previous_headings":"Hypothesis Testing","what":"Logic of hypothesis testing","title":"Applied Statistics for High-throughput Biology: Session 1","text":"Hypotheses made populations based inference samples make inference samples usually observe entire population Sample vs Population Source: https://keydifferences.com/wp-content/uploads/2016/06/population-vs-sample2.jpg","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"one-and-two-sample-hypothesis-tests-of-mean","dir":"Articles","previous_headings":"Hypothesis Testing","what":"One and two-sample hypothesis tests of mean","title":"Applied Statistics for High-throughput Biology: Session 1","text":"One-sample hypothesis test mean - sample comes one two population distributions: \\(H_0: \\mu = \\mu_0\\) (null hypothesis) \\(H_A: \\mu \\neq \\mu_0\\) (alternative hypothesis) Two-sample hypothesis test means - two samples drawn, either: \\(H_0: \\mu_1 = \\mu_2\\) (null hypothesis) \\(H_A: \\mu_1 \\neq \\mu_2\\) (alternative hypothesis)","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"population-vs-sampling-distributions","dir":"Articles","previous_headings":"Hypothesis Testing","what":"Population vs sampling distributions","title":"Applied Statistics for High-throughput Biology: Session 1","text":"realization / point individual realization / point sample distribution depends sample size large sample distributions given Central Limit Theorem sample likely come distribution?","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"note-about-the-central-limit-theorem","dir":"Articles","previous_headings":"Hypothesis Testing","what":"Note about the Central Limit Theorem","title":"Applied Statistics for High-throughput Biology: Session 1","text":"sample size large, average \\(\\bar{Y}\\) random sample: Follows normal distribution normal distribution mean entered population average \\(\\mu_Y\\) standard deviation equal population standard deviation \\(\\sigma_Y\\), divided square root sample size \\(N\\). refer standard deviation distribution random variable random variable’s standard error. Thanks CLT, linear modeling, t-tests, ANOVA guaranteed work reasonably well large samples (~30 observations). Go online demo: http://onlinestatbook.com/stat_sim/sampling_dist/","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"example-applications-of-hypothesis-tests-for-continuous-variables","dir":"Articles","previous_headings":"Hypothesis Testing","what":"Example applications of hypothesis tests for continuous variables","title":"Applied Statistics for High-throughput Biology: Session 1","text":"study participants diet lose weight compared control group? gene knockout result less viable cell colonies, measured number living cells replicate experiments? Prevotella copri abundant guts vegans meat-eaters? infants born region higher birthweight national average? research hypotheses. corresponding null hypotheses?","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"the-z-tests","dir":"Articles","previous_headings":"Hypothesis Testing","what":"The z-tests","title":"Applied Statistics for High-throughput Biology: Session 1","text":"“\\(z\\)” refers Standard Normal Distribution: \\(N(\\mu=0, \\sigma=1)\\) \\(H_0: \\mu = \\mu_0\\) \\(H_0: \\mu_1 = \\mu_2\\) \\(H_0: \\mu_{} = \\mu_{}\\) \\(H_0: \\mu_{upper} = \\mu_{lower}\\)","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"when-to-use-z-tests","dir":"Articles","previous_headings":"Hypothesis Testing","what":"When to use z-tests","title":"Applied Statistics for High-throughput Biology: Session 1","text":"standard deviation \\(\\sigma\\) population known advance population values normally distributed population values slightly skewed n > 15 population values quite skewed n > 30","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"example-of-one-sample-z-test","dir":"Articles","previous_headings":"Hypothesis Testing","what":"Example of one-sample z-test","title":"Applied Statistics for High-throughput Biology: Session 1","text":"","code":"library(TeachingDemos) set.seed(1) (weights = rnorm(10, mean = 75, sd = 10)) #>  [1] 68.73546 76.83643 66.64371 90.95281 78.29508 66.79532 79.87429 82.38325 #>  [9] 80.75781 71.94612 TeachingDemos::z.test(     x = weights,     mu = 70,  #specified for population under H0 because this is a one-sample test     stdev = 10, #specified for population because this is a z-test     alternative = \"two.sided\" ) #>  #>  One Sample z-test #>  #> data:  weights #> z = 1.9992, n = 10.0000, Std. Dev. = 10.0000, Std. Dev. of the sample #> mean = 3.1623, p-value = 0.04559 #> alternative hypothesis: true mean is not equal to 70 #> 95 percent confidence interval: #>  70.12408 82.51998 #> sample estimates: #> mean of weights  #>        76.32203"},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"the-t-tests","dir":"Articles","previous_headings":"Hypothesis Testing","what":"The t-tests","title":"Applied Statistics for High-throughput Biology: Session 1","text":"t-tests small samples rely Central Limit Theorem \\(H_0: \\mu = \\mu_0\\) \\(H_0: \\mu_1 = \\mu_2\\) individuals treatment","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"when-to-use-t-tests","dir":"Articles","previous_headings":"Hypothesis Testing","what":"When to use t-tests","title":"Applied Statistics for High-throughput Biology: Session 1","text":"standard deviation \\(s\\) estimated sample population values normally distributed population values slightly skewed n > 15 population values quite skewed n > 30 e.g. rank data data ranks informative means many ranks arbitrary","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"example-of-one-sample-t-test","dir":"Articles","previous_headings":"Hypothesis Testing","what":"Example of one-sample t-test","title":"Applied Statistics for High-throughput Biology: Session 1","text":"Note specify standard deviation, estimated sample. particular example p-value smaller z-test, general less powerful z-test assumptions met.","code":"stats::t.test(     x = weights,     mu = 70,  #specified for population under H0 because this is a one-sample test     alternative = \"two.sided\" ) #>  #>  One Sample t-test #>  #> data:  weights #> t = 2.5612, df = 9, p-value = 0.03063 #> alternative hypothesis: true mean is not equal to 70 #> 95 percent confidence interval: #>  70.73805 81.90600 #> sample estimates: #> mean of x  #>  76.32203"},{"path":[]},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"why-confidence-intervals","dir":"Articles","previous_headings":"Confidence intervals","what":"Why confidence intervals?","title":"Applied Statistics for High-throughput Biology: Session 1","text":"procedures produced p-values confidence intervals p-values useful deciding whether reject \\(H_0\\) p-values report effect size (observed difference). p-values indicate statistical significance guarantee scientific/clinical significance. Confidence intervals provide probable range true population mean.","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"intervals-for-any-confidence-level","dir":"Articles","previous_headings":"Confidence intervals","what":"Intervals for any confidence level","title":"Applied Statistics for High-throughput Biology: Session 1","text":"\\(\\bar{X} \\pm 1.96 \\times SE\\) (95% CI, normal sampling distribution) \\(\\bar{X} \\pm z_{\\alpha / 2}^{crit} \\times SE\\) (normal sampling distribution) \\(\\bar{X} \\pm t_{\\alpha / 2, df}^{crit} \\times SE\\) (t sampling distribution) part \\(\\pm\\) called margin error","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"confidence-intervals-vs--hypothesis-testing","dir":"Articles","previous_headings":"Confidence intervals","what":"Confidence intervals vs. hypothesis testing","title":"Applied Statistics for High-throughput Biology: Session 1","text":"reject \\(H_0\\) “null value” contained CI two sample hypothesis test \\(H_0: \\mu_1 = \\mu_2\\), must construct single confidence interval \\(\\mu_1 - \\mu_2\\)","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"q-a-confidence-intervals","dir":"Articles","previous_headings":"Confidence intervals","what":"Q & A: confidence intervals","title":"Applied Statistics for High-throughput Biology: Session 1","text":"following true? 95% CI contains 95% values population 95% CI contain population mean, 19 times 20 95% CI 95% probable contain population mean 99% CI wider 95% CI","code":""},{"path":[]},{"path":[]},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"use-and-mis-use-of-the-p-value","dir":"Articles","previous_headings":"Summary - hypothesis testing","what":"Use and mis-use of the p-value","title":"Applied Statistics for High-throughput Biology: Session 1","text":"p-value probability observing sample statistic extreme , assuming \\(H_0\\) true don’t treat precise. don’t silly things like try interpret differences ratios p-values don’t lose track test assumptions independence observations use moderate p-value cutoff, use effect size measure ranking variable repeated sampling, sensitive test assumptions","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"use-and-mis-use-of-the-p-value-contd","dir":"Articles","previous_headings":"Summary - hypothesis testing","what":"Use and mis-use of the p-value (cont’d)","title":"Applied Statistics for High-throughput Biology: Session 1","text":"Failing reject \\(H_0\\) mean \\(H_0\\) true “evidence difference \\(\\neq\\) evidence difference” sample size increases, point estimates mean precise large sample size, small differences means may statistically significant practically significant Although \\(\\alpha = 0.05\\) common cut-p-value, set border “significant” “insignificant,” increasingly strong evidence \\(H_0\\) (favor \\(H_A\\)) p-value gets smaller.","code":""},{"path":[]},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"tips-for-learning-r","dir":"Articles","previous_headings":"R - basic usage","what":"Tips for learning R","title":"Applied Statistics for High-throughput Biology: Session 1","text":"Slide credit: Marcel Ramos","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"installing-packages-the-bioconductor-way","dir":"Articles","previous_headings":"R - basic usage","what":"Installing Packages the Bioconductor Way","title":"Applied Statistics for High-throughput Biology: Session 1","text":"See Bioconductor site info Pseudo code: Works CRAN, GitHub, Bioconductor packages!","code":"install.packages(\"BiocManager\") #from CRAN packages <- c(\"packagename\", \"githubuser/repository\", \"biopackage\") BiocManager::install(packages) BiocManager::valid()  #check validity of installed packages"},{"path":[]},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"base-r-data-types-atomic-vectors","dir":"Articles","previous_headings":"Introduction to the R/Bioconductor data classes","what":"Base R Data Types: atomic vectors","title":"Applied Statistics for High-throughput Biology: Session 1","text":"numeric (set seed sync random number generator): integer: logical: character: factor: real-life recoding factors, try dplyr::recode, dplyr::recode_factor","code":"set.seed(1) rnorm(5) #> [1] -0.6264538  0.1836433 -0.8356286  1.5952808  0.3295078 sample(1L:5L) #> [1] 3 5 1 4 2 1:3 %in% 3 #> [1] FALSE FALSE  TRUE c(\"yes\", \"no\") #> [1] \"yes\" \"no\" factor(c(\"yes\", \"no\")) #> [1] yes no  #> Levels: no yes"},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"base-r-data-types-missingness","dir":"Articles","previous_headings":"Introduction to the R/Bioconductor data classes","what":"Base R Data Types: missingness","title":"Applied Statistics for High-throughput Biology: Session 1","text":"Missing Values others - IMPORTANT class() find class variable.","code":"c(NA, NaN, -Inf, Inf) #> [1]   NA  NaN -Inf  Inf"},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"base-r-data-types-matrix-list-data-frame","dir":"Articles","previous_headings":"Introduction to the R/Bioconductor data classes","what":"Base R Data Types: matrix, list, data.frame","title":"Applied Statistics for High-throughput Biology: Session 1","text":"matrix: list non-atomic vector: data.frame list-like matrix-like properties:","code":"matrix(1:9, nrow = 3) #>      [,1] [,2] [,3] #> [1,]    1    4    7 #> [2,]    2    5    8 #> [3,]    3    6    9 measurements <- c(1.3, 1.6, 3.2, 9.8, 10.2) parents <- c(\"Parent1.name\", \"Parent2.name\") my.list <- list(measurements, parents) my.list #> [[1]] #> [1]  1.3  1.6  3.2  9.8 10.2 #>  #> [[2]] #> [1] \"Parent1.name\" \"Parent2.name\" x <- 11:16 y <- seq(0, 1, .2) z <- c(\"one\", \"two\", \"three\", \"four\", \"five\", \"six\") a <- factor(z) my.df <- data.frame(x, y, z, a, stringsAsFactors = FALSE)"},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"bioconductor-s4-vectors-dataframe","dir":"Articles","previous_headings":"Introduction to the R/Bioconductor data classes","what":"Bioconductor S4 vectors: DataFrame","title":"Applied Statistics for High-throughput Biology: Session 1","text":"GenomicRanges objects Rle (run-length encoding)","code":"suppressPackageStartupMessages(library(S4Vectors)) df <- DataFrame(var1 = Rle(c(\"a\", \"a\", \"b\")),                 var2 = 1:3) metadata(df) <- list(parent = \"DataFrame is my virtual parent\") df #> DataFrame with 3 rows and 2 columns #>    var1      var2 #>   <Rle> <integer> #> 1     a         1 #> 2     a         2 #> 3     b         3"},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"dataframe-is-actually-a-virtual-classes","dir":"Articles","previous_headings":"Introduction to the R/Bioconductor data classes","what":"DataFrame is actually a virtual classes","title":"Applied Statistics for High-throughput Biology: Session 1","text":"Rationale: Methods defined DFrame shared classes inheriting See: https://bioconductor.org/help/course-materials/2019/BiocDevelForum/02-DataFrame.pdf See also: https://github.com/Bioconductor/S4Vectors/issues/90#issue-1026425148","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"list-and-derived-classes","dir":"Articles","previous_headings":"Introduction to the R/Bioconductor data classes","what":"List and derived classes","title":"Applied Statistics for High-throughput Biology: Session 1","text":"","code":"List(my.list) #> List of length 2 str(List(my.list)) #> Formal class 'SimpleList' [package \"S4Vectors\"] with 4 slots #>   ..@ listData       :List of 2 #>   .. ..$ : num [1:5] 1.3 1.6 3.2 9.8 10.2 #>   .. ..$ : chr [1:2] \"Parent1.name\" \"Parent2.name\" #>   ..@ elementType    : chr \"ANY\" #>   ..@ elementMetadata: NULL #>   ..@ metadata       : list() suppressPackageStartupMessages(library(IRanges)) IntegerList(var1 = 1:26, var2 = 1:100) #> IntegerList of length 2 #> [[\"var1\"]] 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 #> [[\"var2\"]] 1 2 3 4 5 6 7 8 9 10 11 12 ... 89 90 91 92 93 94 95 96 97 98 99 100 CharacterList(var1 = letters[1:100], var2 = LETTERS[1:26]) #> CharacterList of length 2 #> [[\"var1\"]] a b c d e f g h i j ... <NA> <NA> <NA> <NA> <NA> <NA> <NA> <NA> <NA> #> [[\"var2\"]] A B C D E F G H I J K L M N O P Q R S T U V W X Y Z LogicalList(var1 = 1:100 %in% 5, var2 = 1:100 %% 2) #> LogicalList of length 2 #> [[\"var1\"]] FALSE FALSE FALSE FALSE TRUE FALSE ... FALSE FALSE FALSE FALSE FALSE #> [[\"var2\"]] TRUE FALSE TRUE FALSE TRUE FALSE ... FALSE TRUE FALSE TRUE FALSE"},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"biostrings","dir":"Articles","previous_headings":"Introduction to the R/Bioconductor data classes","what":"Biostrings","title":"Applied Statistics for High-throughput Biology: Session 1","text":"","code":"suppressPackageStartupMessages(library(Biostrings)) bstring <- BString(\"I am a BString object\") bstring #> 21-letter BString object #> seq: I am a BString object dnastring <- DNAString(\"TTGAAA-CTC-N\") dnastring #> 12-letter DNAString object #> seq: TTGAAA-CTC-N str(dnastring) #> Formal class 'DNAString' [package \"Biostrings\"] with 5 slots #>   ..@ shared         :Formal class 'SharedRaw' [package \"XVector\"] with 2 slots #>   .. .. ..@ xp                    :<externalptr>  #>   .. .. ..@ .link_to_cached_object:<environment: 0x55f475b61dd8>  #>   ..@ offset         : int 0 #>   ..@ length         : int 12 #>   ..@ elementMetadata: NULL #>   ..@ metadata       : list() alphabetFrequency(dnastring, baseOnly=TRUE, as.prob=TRUE) #>          A          C          G          T      other  #> 0.25000000 0.16666667 0.08333333 0.25000000 0.25000000"},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"rangedsummarizedexperiment","dir":"Articles","previous_headings":"Introduction to the R/Bioconductor data classes","what":"(Ranged)SummarizedExperiment","title":"Applied Statistics for High-throughput Biology: Session 1","text":"* Source: https://bioconductor.org/packages/SummarizedExperiment/","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"rangedsummarizedexperiment-1","dir":"Articles","previous_headings":"Introduction to the R/Bioconductor data classes","what":"(Ranged)SummarizedExperiment","title":"Applied Statistics for High-throughput Biology: Session 1","text":"RangedSummarizedExperiment de facto standard “rectangular” data metadata Extended SingleCellExperiment, DESeqDataSet Emulated MultiAssayExperiment","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day1_intro.html","id":"lab-exercises-and-links","dir":"Articles","previous_headings":"Introduction to the R/Bioconductor data classes","what":"Lab Exercises and Links","title":"Applied Statistics for High-throughput Biology: Session 1","text":"OSCA Introduction Chapter 3: Getting scRNA-seq datasets OSCA Introduction Chapter 4: SingleCellExperiment class (time allows) built html version lecture available. source R Markdown also available Github.","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"schematic-of-a-typical-scrna-seq-analysis-workflow","dir":"Articles","previous_headings":"","what":"Schematic of a typical scRNA-seq analysis workflow","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Single-cell workflow stage (separated dashed lines) consists number specific steps, many operate modify SingleCellExperiment instance. (original image)","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"day-4-outline","dir":"Articles","previous_headings":"","what":"Day 4 outline","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Book chapter 8: Distances high dimensions Principal Components Analysis Singular Value Decomposition Multidimensional Scaling t-SNE UMAP","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"metrics-and-distances","dir":"Articles","previous_headings":"","what":"Metrics and distances","title":"Applied Statistics for High-throughput Biology: Session 2","text":"metric satisfies following five properties: non-negativity \\(d(, b) \\ge 0\\) symmetry \\(d(, b) = d(b, )\\) identification mark \\(d(, ) = 0\\) definiteness \\(d(, b) = 0\\) \\(=b\\) triangle inequality \\(d(, b) + d(b, c) \\ge d(, c)\\) distance required satisfy 1-3. similarity function satisfies 1-2, increases \\(\\) \\(b\\) become similar dissimilarity function satisfies 1-2, decreases \\(\\) \\(b\\) become similar","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"euclidian-distance-metric","dir":"Articles","previous_headings":"","what":"Euclidian distance (metric)","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Remember grade school:  Euclidean d = \\(\\sqrt{ (A_x-B_x)^2 + (A_y-B_y)^2}\\). Side note: also referred \\(L_2\\) norm","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"euclidian-distance-in-high-dimensions","dir":"Articles","previous_headings":"","what":"Euclidian distance in high dimensions","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Interested identifying similar samples similar genes","code":"## BiocManager::install(\"genomicsclass/tissuesGeneExpression\") #if needed ## BiocManager::install(\"genomicsclass/GSE5859\") #if needed library(GSE5859) library(tissuesGeneExpression) data(tissuesGeneExpression) dim(e) ##gene expression data #> [1] 22215   189 table(tissue) ##tissue[i] corresponds to e[,i] #> tissue #>  cerebellum       colon endometrium hippocampus      kidney       liver  #>          38          34          15          31          39          26  #>    placenta  #>           6"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"notes-about-euclidian-distance-in-high-dimensions","dir":"Articles","previous_headings":"","what":"Notes about Euclidian distance in high dimensions","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Points longer Cartesian plane sample \\(\\) defined point 22,215 dimensional space: \\((Y_{1,},\\dots,Y_{22215,})^\\top\\). feature \\(g\\) defined point 189 dimensions \\((Y_{g,189},\\dots,Y_{g,189})^\\top\\) Euclidean distance two dimensions. E.g., distance two samples \\(\\) \\(j\\) : \\[ \\mbox{dist}(,j) = \\sqrt{ \\sum_{g=1}^{22215} (Y_{g,}-Y_{g,j })^2 } \\] distance two features \\(h\\) \\(g\\) : \\[ \\mbox{dist}(h,g) = \\sqrt{ \\sum_{=1}^{189} (Y_{h,}-Y_{g,})^2 } \\]","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"euclidian-distance-in-matrix-algebra-notation","dir":"Articles","previous_headings":"","what":"Euclidian distance in matrix algebra notation","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Euclidian distance samples \\(\\) \\(j\\) can written : \\[ \\mbox{dist}(,j) = \\sqrt{ (\\mathbf{Y}_i - \\mathbf{Y}_j)^\\top(\\mathbf{Y}_i - \\mathbf{Y}_j) }\\] \\(\\mathbf{Y}_i\\) \\(\\mathbf{Y}_j\\) columns \\(\\) \\(j\\).","code":"t(matrix(1:3, ncol = 1)) #>      [,1] [,2] [,3] #> [1,]    1    2    3 matrix(1:3, ncol = 1) #>      [,1] #> [1,]    1 #> [2,]    2 #> [3,]    3 t(matrix(1:3, ncol = 1)) %*% matrix(1:3, ncol = 1) #>      [,1] #> [1,]   14"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"note-about-matrix-algebra-in-r","dir":"Articles","previous_headings":"","what":"Note about matrix algebra in R","title":"Applied Statistics for High-throughput Biology: Session 2","text":"R efficient matrix algebra Matrix CRAN package (sparse matrices) rhdf5 DelayedArray Bioconductor package (-disk arrays)","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"sample-example","dir":"Articles","previous_headings":"","what":"3 sample example","title":"Applied Statistics for High-throughput Biology: Session 2","text":"","code":"kidney1 <- e[, 1] kidney2 <- e[, 2] colon1 <- e[, 87] sqrt(sum((kidney1 - kidney2) ^ 2)) #> [1] 85.8546 sqrt(sum((kidney1 - colon1) ^ 2)) #> [1] 122.8919"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"sample-example-using-dist","dir":"Articles","previous_headings":"","what":"3 sample example using dist()","title":"Applied Statistics for High-throughput Biology: Session 2","text":"","code":"dim(e) #> [1] 22215   189 (d <- dist(t(e[, c(1, 2, 87)]))) #>                 GSM11805.CEL.gz GSM11814.CEL.gz #> GSM11814.CEL.gz         85.8546                 #> GSM92240.CEL.gz        122.8919        115.4773 class(d) #> [1] \"dist\""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"the-dist-function","dir":"Articles","previous_headings":"","what":"The dist() function","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Excerpt ?dist: must one “euclidean”, “maximum”, “manhattan”, “canberra”, “binary” “minkowski”. unambiguous substring can given. dist class output dist() used many clustering algorithms heatmap functions Caution: dist(e) creates 22215 x 22215 matrix probably crash R session.","code":"dist(     x,     method = \"euclidean\",     diag = FALSE,     upper = FALSE,     p = 2 )"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"note-on-standardization","dir":"Articles","previous_headings":"","what":"Note on standardization","title":"Applied Statistics for High-throughput Biology: Session 2","text":"practice, features (e.g. genes) typically “standardized”, .e. converted z-score: \\[x_{gi} \\leftarrow \\frac{(x_{gi} - \\bar{x}_g)}{s_g}\\] GC bias, PCR amplification efficiency, … \\(\\frac{d_E(x, y)^2}{2m} = 1 - r_{xy}\\) \\(m\\) = # dimensions","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"dimension-reduction-and-pca","dir":"Articles","previous_headings":"","what":"Dimension reduction and PCA","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Motivation dimension reduction Simulate heights twin pairs:","code":"set.seed(1) n <- 100 y <- t(MASS::mvrnorm(n, c(0, 0), matrix(c(1, 0.95, 0.95, 1), 2, 2))) dim(y) #> [1]   2 100 cor(t(y)) #>           [,1]      [,2] #> [1,] 1.0000000 0.9433295 #> [2,] 0.9433295 1.0000000"},{"path":[]},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"not-much-distance-is-lost-in-the-second-dimension","dir":"Articles","previous_headings":"","what":"Not much distance is lost in the second dimension","title":"Applied Statistics for High-throughput Biology: Session 2","text":"twin heights highly correlated","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"singular-value-decomposition-svd","dir":"Articles","previous_headings":"","what":"Singular Value Decomposition (SVD)","title":"Applied Statistics for High-throughput Biology: Session 2","text":"SVD generalizes example rotation looked : \\[\\mathbf{Y} = \\mathbf{UDV}^\\top\\] note: formulation \\(m\\) rows \\(> n\\) columns \\(\\mathbf{Y}\\): \\(m\\) rows x \\(n\\) cols matrix measurements \\(\\mathbf{U}\\): \\(m \\times n\\) matrix relating original scores PCA scores (loadings) \\(\\mathbf{D}\\): \\(n \\times n\\) diagonal matrix (eigenvalues) \\(\\mathbf{V}\\): \\(n \\times n\\) orthogonal matrix (eigenvectors PCA scores) orthogonal = unit length “perpendicular” 3-D","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"svd-of-gene-expression-dataset","dir":"Articles","previous_headings":"","what":"SVD of gene expression dataset","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Scaling: SVD:","code":"e.standardize <- t(scale(t(e), scale = FALSE)) s <- svd(e.standardize) names(s) #> [1] \"d\" \"u\" \"v\""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"components-of-svd-results","dir":"Articles","previous_headings":"","what":"Components of SVD results","title":"Applied Statistics for High-throughput Biology: Session 2","text":"","code":"dim(s$u)     # loadings #> [1] 22215   189 length(s$d)  # eigenvalues #> [1] 189 dim(s$v)     # d %*% vT = scores #> [1] 189 189"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"pca-is-a-svd","dir":"Articles","previous_headings":"","what":"PCA is a SVD","title":"Applied Statistics for High-throughput Biology: Session 2","text":"gene expression dataset  Lesson: u v can multiplied -1 arbitrarily","code":"rafalib::mypar() p <- prcomp(t(e.standardize)) plot(s$u[, 1] ~ p$rotation[, 1])"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"pca-interpretation-loadings","dir":"Articles","previous_headings":"","what":"PCA interpretation: loadings","title":"Applied Statistics for High-throughput Biology: Session 2","text":"think principal component axes weighted combination original axes","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"visualizing-pca-loadings","dir":"Articles","previous_headings":"","what":"Visualizing PCA loadings","title":"Applied Statistics for High-throughput Biology: Session 2","text":"","code":"plot(p$rotation[, 1],      xlab = \"Index of genes\",      ylab = \"Loadings of PC1\",      main = \"PC1 loadings of each gene\") #or, predict(p) abline(h = c(-0.03, 0.03), col = \"red\")"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"genes-with-high-pc1-loadings","dir":"Articles","previous_headings":"","what":"Genes with high PC1 loadings","title":"Applied Statistics for High-throughput Biology: Session 2","text":"","code":"e.pc1genes <-     e.standardize[p$rotation[, 1] < -0.03 |                            p$rotation[, 1] > 0.03,] pheatmap::pheatmap(     e.pc1genes,     scale = \"none\",     show_rownames = TRUE,     show_colnames = FALSE )"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"pca-interpretation-eigenvalues","dir":"Articles","previous_headings":"","what":"PCA interpretation: eigenvalues","title":"Applied Statistics for High-throughput Biology: Session 2","text":"\\(\\mathbf{D}\\) (eigenvalues): standard deviation scaling factor decomposed variable multiplied .","code":"rafalib::mypar() plot(     p$sdev ^ 2 / sum(p$sdev ^ 2) * 100,     xlim = c(0, 150),     type = \"b\",     ylab = \"% variance explained\",     main = \"Screeplot\" )"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"pca-interpretation-eigenvalues-1","dir":"Articles","previous_headings":"","what":"PCA interpretation: eigenvalues","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Alternatively cumulative % variance explained (using cumsum() function)","code":"rafalib::mypar() plot(     cumsum(p$sdev ^ 2) / sum(p$sdev ^ 2) * 100,     ylab = \"cumulative % variance explained\",     ylim = c(0, 100),     type = \"b\",     main = \"Cumulative screeplot\" )"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"pca-interpretation-scores","dir":"Articles","previous_headings":"","what":"PCA interpretation: scores","title":"Applied Statistics for High-throughput Biology: Session 2","text":"\\(\\mathbf{V}\\) (scores): “datapoints” reduced prinipal component space implementations (like prcomp()), scores already scaled eigenvalues: \\(\\mathbf{D V^T}\\)","code":""},{"path":[]},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"multi-dimensional-scaling-mds","dir":"Articles","previous_headings":"","what":"Multi-dimensional Scaling (MDS)","title":"Applied Statistics for High-throughput Biology: Session 2","text":"also referred Principal Coordinates Analysis (PCoA) reduced SVD, performed distance matrix identify two () eigenvalues/vectors preserve distances","code":"d <- as.dist(1 - cor(e.standardize)) mds <- cmdscale(d)"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"t-sne","dir":"Articles","previous_headings":"","what":"t-SNE","title":"Applied Statistics for High-throughput Biology: Session 2","text":"almost magical ability show clearly separated clusters performs different transformations different regions computationally intensive usually done top ~30 PCs “perplexity” parameter defines (loosely) balance attention local global aspects data optimal choice perplexity changes different numbers cells sample. perplexity = \\(\\sqrt{N}\\) one rule thumb. \\(max(N/5, 50)\\) another (default Rtsne) good post Nikolay Oskolkov topic.","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"t-sne-caveats","dir":"Articles","previous_headings":"","what":"t-SNE caveats","title":"Applied Statistics for High-throughput Biology: Session 2","text":"uses random number generator apparent spread clusters completely meaningless distance clusters might also mean anything parameters can tuned make data appear want can show apparent clusters random noise. used statistical inference Try gain intuition: https://distill.pub/2016/misread-tsne/) tSNE","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"pca-of-zeisel-single-cell-rna-seq-dataset","dir":"Articles","previous_headings":"","what":"PCA of Zeisel single-cell RNA-seq dataset","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Principal Components Analysis Zeisel dataset","code":"sce.zeisel <- fixedPCA(sce.zeisel, subset.row=NULL) plotReducedDim(sce.zeisel, dimred=\"PCA\", colour_by=\"level1class\")"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"t-sne-of-the-same-dataset","dir":"Articles","previous_headings":"","what":"t-SNE of the same dataset","title":"Applied Statistics for High-throughput Biology: Session 2","text":"t-SNE clustering Zeisel dataset","code":"sce.zeisel <- runTSNE(sce.zeisel, dimred=\"PCA\") plotReducedDim(sce.zeisel, dimred=\"TSNE\", colour_by=\"level1class\")"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"umap-vs-t-sne","dir":"Articles","previous_headings":"","what":"UMAP vs t-SNE","title":"Applied Statistics for High-throughput Biology: Session 2","text":"UMAP may better preserve local global distances tends compact visual clusters empty space computationally efficient also involves random number generation Note: prefer setting random number seed exploratory analysis order see random variability","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"umap-of-the-same-dataset","dir":"Articles","previous_headings":"","what":"UMAP of the same dataset","title":"Applied Statistics for High-throughput Biology: Session 2","text":"UMAP representation Zeisel dataset","code":"sce.zeisel <- runUMAP(sce.zeisel, dimred=\"PCA\") plotReducedDim(sce.zeisel, dimred=\"UMAP\", colour_by=\"level1class\")"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"tsne-of-tissue-microarray-data","dir":"Articles","previous_headings":"","what":"tSNE of tissue microarray data","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Using default parameters log transformation","code":"sct <- SingleCellExperiment(e) sct$tissue <- tissue # fake the log normalization because it is undesirable for microarray data names(assays(sct)) <- \"logcounts\"  sct <- fixedPCA(sct, subset.row=NULL) sct <- runTSNE(sct, dimred=\"PCA\") plotReducedDim(sct, dimred=\"TSNE\", colour_by=\"tissue\")"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"umap-of-tissue-microarray-data","dir":"Articles","previous_headings":"","what":"UMAP of tissue microarray data","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Also using default parameters log transformation","code":"sct <- runUMAP(sct, dimred=\"PCA\") plotReducedDim(sct, dimred=\"UMAP\", colour_by=\"tissue\")"},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"summary-distances-and-dimension-reduction","dir":"Articles","previous_headings":"","what":"Summary: distances and dimension reduction","title":"Applied Statistics for High-throughput Biology: Session 2","text":"Note: signs eigenvalues (square get variances) eigenvectors (loadings) can arbitrarily flipped PCA MDS useful dimension reduction correlated variables Variables always centered. Variables also scaled unless know scale population PCA projection can applied new datasets know matrix calculations PCA subject -fitting, screeplot can tested cross-validation PCA often used prior t-SNE UMAP de-noising computational tractability","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"lab-exercise","dir":"Articles","previous_headings":"","what":"Lab exercise","title":"Applied Statistics for High-throughput Biology: Session 2","text":"OSCA Basics: Chapter 4 Dimensionality Reduction Optional interested, OSCA Advanced: Chapter 4 Dimensionality reduction, redux","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day2_unsupervised.html","id":"links","dir":"Articles","previous_headings":"","what":"Links","title":"Applied Statistics for High-throughput Biology: Session 2","text":"built html version lecture available. source R Markdown also available Github.","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"outline","dir":"Articles","previous_headings":"","what":"Outline","title":"Applied Statistics for High-throughput Biology: Session 3","text":"Continuous categorical predictors Interactions Model formulae Linear, logistic, log-Linear links Poisson, Negative Binomial error distributions Multiple Hypothesis Testing","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"textbook-sources","dir":"Articles","previous_headings":"","what":"Textbook sources","title":"Applied Statistics for High-throughput Biology: Session 3","text":"Chapter 5: Linear models Chapter 6: Inference high-dimensional data Chapter 6: Testing Chapter 4: DE analyses conditions","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"example-friction-of-spider-legs","dir":"Articles","previous_headings":"","what":"Example: friction of spider legs","title":"Applied Statistics for High-throughput Biology: Session 3","text":"() Barplot showing total claw tuft area corresponding legs. (B) Boxplot presenting friction coefficient data illustrating median, interquartile range extreme values.","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"questions","dir":"Articles","previous_headings":"","what":"Questions","title":"Applied Statistics for High-throughput Biology: Session 3","text":"pulling pushing friction coefficients different? friction coefficients different different leg pairs? difference pulling pushing friction coefficients vary leg pair?","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"qualitative-answers","dir":"Articles","previous_headings":"","what":"Qualitative answers","title":"Applied Statistics for High-throughput Biology: Session 3","text":"Notes: Pulling friction higher Pulling (pushing) friction increases back legs (L1 -> 4) Variance isn’t constant","code":"table(spider$leg,spider$type) #>      #>      pull push #>   L1   34   34 #>   L2   15   15 #>   L3   52   52 #>   L4   40   40 summary(spider) #>      leg                type              friction      #>  Length:282         Length:282         Min.   :0.1700   #>  Class :character   Class :character   1st Qu.:0.3900   #>  Mode  :character   Mode  :character   Median :0.7600   #>                                        Mean   :0.8217   #>                                        3rd Qu.:1.2400   #>                                        Max.   :1.8400 boxplot(spider$friction ~ spider$type * spider$leg,         col=c(\"grey90\",\"grey40\"), las=2,         main=\"Friction coefficients of different leg pairs\")"},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"what-are-linear-models","dir":"Articles","previous_headings":"","what":"What are linear models?","title":"Applied Statistics for High-throughput Biology: Session 3","text":"following examples linear models: \\(Y_i = \\beta_0 + \\beta_1 x_i + \\varepsilon_i\\) (simple linear regression) \\(Y_i = \\beta_0 + \\beta_1 x_i + \\beta_2 x_i^2 + \\varepsilon_i\\) (quadratic regression) \\(Y_i = \\beta_0 + \\beta_1 x_i + \\beta_2 \\times 2^{x_i} + \\varepsilon_i\\) (\\(2^{x_i}\\) new transformed variable)","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"multiple-linear-regression-model","dir":"Articles","previous_headings":"","what":"Multiple linear regression model","title":"Applied Statistics for High-throughput Biology: Session 3","text":"Linear models can number predictors Systematic part model: \\[ E[y|x] = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + ... + \\beta_p x_p \\] \\(E[y|x]\\) expected value \\(y\\) given \\(x\\) \\(y\\) outcome, response, dependent variable \\(x\\) vector predictors / independent variables \\(x_p\\) individual predictors independent variables \\(\\beta_p\\) regression coefficients Random part model: \\(y_i = E[y_i|x_i] + \\epsilon_i\\) Assumptions linear models: \\(\\epsilon_i \\stackrel{iid}{\\sim} N(0, \\sigma_\\epsilon^2)\\) Normal distribution Mean zero every value predictors Constant variance every value predictors Values statistically independent","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"continuous-predictors","dir":"Articles","previous_headings":"","what":"Continuous predictors","title":"Applied Statistics for High-throughput Biology: Session 3","text":"Coding: -, may scaled unit variance (results adjusted regression coefficients) Interpretation linear regression: increase one unit predictor results much difference continuous outcome variable","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"binary-predictors-2-levels","dir":"Articles","previous_headings":"","what":"Binary predictors (2 levels)","title":"Applied Statistics for High-throughput Biology: Session 3","text":"Coding: indicator dummy variable (0-1 coding) e.g. \\(E(y|x) = \\beta_0 + \\beta_1 x\\) x={ 1 push friction, 0 pull friction }","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"multilevel-categorical-predictors-ordinal-or-nominal","dir":"Articles","previous_headings":"","what":"Multilevel categorical predictors (ordinal or nominal)","title":"Applied Statistics for High-throughput Biology: Session 3","text":"Coding: \\(K-1\\) dummy variables \\(K\\)-level categorical variable L2={1 \\(2^{nd}\\) leg pair, 0 otherwise}, L3={1 \\(3^{nd}\\) leg pair, 0 otherwise}, L4={1 \\(4^{th}\\) leg pair, 0 otherwise}. R re-codes factors dummy variables automatically. Dummy coding depends reference level","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"model-formulae-in-r","dir":"Articles","previous_headings":"","what":"Model formulae in R","title":"Applied Statistics for High-throughput Biology: Session 3","text":"Model formulae tutorial regression functions R aov(), lm(), glm(), coxph() use “model formula” interface. formula determines model built (tested) R procedure. basic format : > response variable ~ explanatory variables tilde means “modeled ” “modeled function .”","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"regression-with-a-single-predictor","dir":"Articles","previous_headings":"","what":"Regression with a single predictor","title":"Applied Statistics for High-throughput Biology: Session 3","text":"Model formula simple linear regression: > y ~ x “x” explanatory (independent) variable “y” response (dependent) variable.","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"return-to-the-spider-legs","dir":"Articles","previous_headings":"","what":"Return to the spider legs","title":"Applied Statistics for High-throughput Biology: Session 3","text":"Friction coefficient leg type first leg pair:","code":"spider.sub <- dplyr::filter(spider, leg==\"L1\") fit <- lm(friction ~ type, data=spider.sub) summary(fit) #>  #> Call: #> lm(formula = friction ~ type, data = spider.sub) #>  #> Residuals: #>      Min       1Q   Median       3Q      Max  #> -0.33147 -0.10735 -0.04941 -0.00147  0.76853  #>  #> Coefficients: #>             Estimate Std. Error t value Pr(>|t|)     #> (Intercept)  0.92147    0.03827  24.078  < 2e-16 *** #> typepush    -0.51412    0.05412  -9.499  5.7e-14 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #>  #> Residual standard error: 0.2232 on 66 degrees of freedom #> Multiple R-squared:  0.5776, Adjusted R-squared:  0.5711  #> F-statistic: 90.23 on 1 and 66 DF,  p-value: 5.698e-14"},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"regression-on-spider-leg-type","dir":"Articles","previous_headings":"","what":"Regression on spider leg type","title":"Applied Statistics for High-throughput Biology: Session 3","text":"Regression coefficients friction ~ type first set spider legs:  Coefficients (Intercept) typepush Coefficients t-distributed assumptions correct Standard deviation estimates coefficient can calculated (standard errors)","code":"broom::tidy(fit) #> # A tibble: 2 × 5 #>   term        estimate std.error statistic  p.value #>   <chr>          <dbl>     <dbl>     <dbl>    <dbl> #> 1 (Intercept)    0.921    0.0383     24.1  2.12e-34 #> 2 typepush      -0.514    0.0541     -9.50 5.70e-14"},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"interpretation-of-spider-leg-type-coefficients","dir":"Articles","previous_headings":"","what":"Interpretation of spider leg type coefficients","title":"Applied Statistics for High-throughput Biology: Session 3","text":"Diagram estimated coefficients linear model. green arrow indicates Intercept term, goes zero mean reference group (‘pull’ samples). orange arrow indicates difference push group pull group, negative example. circles show individual samples, jittered horizontally avoid overplotting.","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"regression-on-spider-leg-position","dir":"Articles","previous_headings":"","what":"regression on spider leg position","title":"Applied Statistics for High-throughput Biology: Session 3","text":"Remember positions 1-4 Interpretation dummy variables legL2, legL3, legL4 ?","code":"fit <- lm(friction ~ leg, data=spider) fit.table <- xtable::xtable(fit, label=NULL) print(fit.table, type=\"html\")"},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"regression-with-multiple-predictors","dir":"Articles","previous_headings":"","what":"Regression with multiple predictors","title":"Applied Statistics for High-throughput Biology: Session 3","text":"Additional explanatory variables can added follows: > y ~ x + z Note “+” usual meaning, achieved : > y ~ (x + z)","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"regression-on-spider-leg-type-and-position","dir":"Articles","previous_headings":"","what":"Regression on spider leg type and position","title":"Applied Statistics for High-throughput Biology: Session 3","text":"Remember positions 1-4 model still doesn’t represent friction differences different leg positions modified whether pulling pushing","code":"fit <- lm(friction ~ type + leg, data=spider) fit.table <- xtable::xtable(fit, label=NULL) print(fit.table, type=\"html\")"},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"interaction-effect-modification","dir":"Articles","previous_headings":"","what":"Interaction (effect modification)","title":"Applied Statistics for High-throughput Biology: Session 3","text":"Interaction modeled product two covariates: \\[ E[y|x] = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\beta_{12} x_1*x_2 \\] Interaction coffee time day performance Image credit: http://personal.stevens.edu/~ysakamot/","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"model-formulae-contd","dir":"Articles","previous_headings":"","what":"Model formulae (cont’d)","title":"Applied Statistics for High-throughput Biology: Session 3","text":"Note: order generally doesn’t matter (u+v v+u)","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"summary-types-of-standard-linear-models","dir":"Articles","previous_headings":"","what":"Summary: types of standard linear models","title":"Applied Statistics for High-throughput Biology: Session 3","text":"u v factors: ANOVAu v numeric: multiple regression one factor, one numeric: ANCOVA sure know classes variables sure rows regression output make sense","code":"lm( y ~ u + v)"},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"generalized-linear-models","dir":"Articles","previous_headings":"","what":"Generalized Linear Models","title":"Applied Statistics for High-throughput Biology: Session 3","text":"Linear regression special case broad family models called “Generalized Linear Models” (GLM) unifying approach allows fit large set models using maximum likelihood estimation methods (MLE) (Nelder & Wedderburn, 1972) Can model many types data directly using appropriate distributions, e.g. Poisson distribution count data Transformations \\(y\\) needed","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"components-of-a-glm","dir":"Articles","previous_headings":"","what":"Components of a GLM","title":"Applied Statistics for High-throughput Biology: Session 3","text":"\\[ g\\left( E[y|x] \\right) = \\beta_0 + \\beta_1 x_{1i} + \\beta_2 x_{2i} + ... + \\beta_p x_{pi} \\] doesn’t normal can distribution “exponential” family distributions Systematic component specifies linear function predictors (linear predictor) can linear nonlinear","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"linear-regression-as-glm","dir":"Articles","previous_headings":"","what":"Linear Regression as GLM","title":"Applied Statistics for High-throughput Biology: Session 3","text":"Useful log-transformed microarray data model: \\(y_i = E[y|x] + \\epsilon_i = \\beta_0 + \\beta_1 x_{1i} + \\beta_2 x_{2i} + ... + \\beta_p x_{pi} + \\epsilon_i\\) Random component \\(y_i\\) normally distributed: \\(\\epsilon_i \\stackrel{iid}{\\sim} N(0, \\sigma_\\epsilon^2)\\) Systematic component (linear predictor): \\(\\beta_0 + \\beta_1 x_{1i} + \\beta_2 x_{2i} + ... + \\beta_p x_{pi}\\) Link function identity link: \\(g(E(y | x)) = E(y | x)\\). modeling mean directly, transformation.","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"logistic-regression-as-glm","dir":"Articles","previous_headings":"","what":"Logistic Regression as GLM","title":"Applied Statistics for High-throughput Biology: Session 3","text":"Useful binary outcomes, e.g. Single Nucleotide Polymorphisms somatic variants model: \\[ Logit(P(x)) = log \\left( \\frac{P(x)}{1-P(x)} \\right) = \\beta_0 + \\beta_1 x_{1i} + \\beta_2 x_{2i} + ... + \\beta_p x_{pi} \\] Random component: \\(y_i\\) follows Binomial distribution (outcome binary variable) Systematic component: linear predictor \\[ \\beta_0 + \\beta_1 x_{1i} + \\beta_2 x_{2i} + ... + \\beta_p x_{pi} \\] Link function: logit (log odds event occurs) \\[ g(P(x)) = logit(P(x)) = log\\left( \\frac{P(x)}{1-P(x)} \\right) \\] \\[ P(x) = g^{-1}\\left( \\beta_0 + \\beta_1 x_{1i} + \\beta_2 x_{2i} + ... + \\beta_p x_{pi} \\right) \\]","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"log-linear-glm","dir":"Articles","previous_headings":"","what":"Log-linear GLM","title":"Applied Statistics for High-throughput Biology: Session 3","text":"systematic part GLM : \\[ log\\left( E[y|x] \\right) = \\beta_0 + \\beta_1 x_{1i} + \\beta_2 x_{2i} + ... + \\beta_p x_{pi} + log(t_i) \\] can account differences sequencing depth offset \\(log(t_i)\\) guarantees non-negative expected number counts often used conjunction Poisson Negative Binomial error models","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"poisson-error-model","dir":"Articles","previous_headings":"","what":"Poisson error model","title":"Applied Statistics for High-throughput Biology: Session 3","text":"\\[ f(k, \\lambda) = e^{-\\lambda} \\frac{\\lambda^k}{k!} \\] \\(f\\) probability \\(k\\) events (e.g. # reads counted), \\(\\lambda\\) mean number events, \\(E[y|x]\\) \\(\\lambda\\) also variance number events","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"negative-binomial-error-model","dir":"Articles","previous_headings":"","what":"Negative Binomial error model","title":"Applied Statistics for High-throughput Biology: Session 3","text":"aka gamma–Poisson mixture distribution \\[ f(k, \\lambda, \\theta) = \\frac{\\Gamma(\\frac{1 + \\theta k}{\\theta})}{k! \\, \\Gamma(\\frac{1}{\\theta})}     \\left(\\frac{\\theta m}{1+\\theta m}\\right)^k     \\left(1+\\theta m\\right)^\\theta     \\quad\\text{}k = 0, 1, 2, \\dotsc \\] \\(f\\) still probability \\(k\\) events (e.g. # reads counted), \\(\\lambda\\) still mean number events, \\(E[y|x]\\) \\(\\theta \\rightarrow 0\\): Poisson distribution \\(\\theta \\rightarrow \\infty\\): Gamma distribution Poisson model can considered nested within Negative Binomial model likelihood ratio test comparing two models possible","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"compare-poisson-vs--negative-binomial","dir":"Articles","previous_headings":"","what":"Compare Poisson vs. Negative Binomial","title":"Applied Statistics for High-throughput Biology: Session 3","text":"# trials n, probability success p","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"additive-vs--multiplicative-models","dir":"Articles","previous_headings":"","what":"Additive vs. multiplicative models","title":"Applied Statistics for High-throughput Biology: Session 3","text":"e.g. two binary variables \\(\\beta_1 = 1.5\\), \\(\\beta_2 = 1.5\\). \\(x_1=1\\) \\(x_2=1\\), adds 3.0 \\(E(y|x)\\) \\(x_1=1\\) \\(x_2=1\\), adds 3.0 \\(log(\\frac{P}{1-P})\\) Odds-ratio \\(\\frac{P}{1-P}\\) increases 20-fold: \\(exp(1.5+1.5)\\) \\(exp(1.5) * exp(1.5)\\)","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"inference-in-high-dimensions-many-variables","dir":"Articles","previous_headings":"","what":"Inference in high dimensions (many variables)","title":"Applied Statistics for High-throughput Biology: Session 3","text":"\\(Y_i\\) expression gene, etc mean expression gene different two groups (t-test) mean expression gene different several groups (1-way ANOVA) simple analysis thousands times note: small sample sizes, Bayesian improvements can made (.e. limma, edgeR, DESeq2) prediction machine learning \\(Y\\) label like patient outcome, can high-dimensional predictors","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"multiple-testing","dir":"Articles","previous_headings":"","what":"Multiple testing","title":"Applied Statistics for High-throughput Biology: Session 3","text":"testing thousands true null hypotheses \\(\\alpha = 0.05\\), expect 5% type error rate p-values even smaller expect chance multiple testing? Two mainstream approaches controlling type error rate: Controlling FWER 0.05 ensures probably type errors < 0.05. Controlling FDR 0.05 ensures fraction type errors < 0.05. see MSMB Chapter 6 - testing","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"benjamini-hochberg-fdr-algorithm","dir":"Articles","previous_headings":"","what":"Benjamini-Hochberg FDR algorithm","title":"Applied Statistics for High-throughput Biology: Session 3","text":"Source: MSMB Chapter 6 order p-values \\(m\\) hypothesis tests increasing order, \\(p_1, \\ldots, p_m\\) choice \\(\\phi\\) (target FDR), find largest value \\(k\\) satisfies: \\(p_k \\leq \\phi k/m\\) reject hypotheses \\(1, \\ldots, k\\) Benjamini-Hochberg FDR, visually Important notes intuition: can FDR < 0.05 thousands tests even smallest p-value 0.01 0.001 (ie permutation tests) FDR property groups tests, individual tests rank FDR values can different rank p-values","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"fdr-alternatives-to-benjamini-hochberg","dir":"Articles","previous_headings":"","what":"FDR alternatives to Benjamini-Hochberg","title":"Applied Statistics for High-throughput Biology: Session 3","text":"q-value test estimates proportion false positives incurred particular test smaller p-values called significant (packages: qvalue fdrtool) q-value increases monotonically p-value (unlike Benjamini-Hochberg FDR) can improve power modeling relationship covariate property (mean expression) probability rejecting \\(H_0\\) works best lots tests (ie, thousands) implemented IHW Bioconductor package DESeq2","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"beware-of-double-dipping-in-statistical-inference","dir":"Articles","previous_headings":"","what":"Beware of “double-dipping” in statistical inference","title":"Applied Statistics for High-throughput Biology: Session 3","text":"define separation observations test difference across separation Example : García-Mantrana et al., Gut Microbes 2020 full treatment see https://arxiv.org/abs/2012.02936 https://pubmed.ncbi.nlm.nih.gov/31521605 nice lecture: Daniela Whitten “Double-dipping” statistics: https://youtu./tiv--XjPl9M","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"simple-example-of-double-dipping","dir":"Articles","previous_headings":"","what":"Simple example of double-dipping","title":"Applied Statistics for High-throughput Biology: Session 3","text":"Step 1: define age classifier Elderly >70 yrs Youth <18 years Otherwise unclassified Step 2: test difference ages elderly youth IMPORTANT: Even applying fully-specified classifier validation dataset protect inflated p-values “double-dipping”","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"Applied Statistics for High-throughput Biology: Session 3","text":"Linear models basis identifying differential expression / differential abundance Generalized Linear Models extend linear regression : binary \\(y\\) (logistic regression) count \\(y\\) (log-linear regression e.g. Poisson Negative Binomial link functions) FWER, FDR, local FDR (q-value), Independent Hypothesis Testing aware “double-dipping” statistical inference","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"exercises","dir":"Articles","previous_headings":"","what":"Exercises","title":"Applied Statistics for High-throughput Biology: Session 3","text":"Repeat analyses OSCA multi-sample Chapter 4: DE analyses conditions Please discuss following questions: (note, inference problem acknowledged section) related problem hypothesis testing 4.4 Performing DE analysis? might avoid problems, data multi’omic technology?","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day3_linearmodels.html","id":"links","dir":"Articles","previous_headings":"","what":"Links","title":"Applied Statistics for High-throughput Biology: Session 3","text":"built html version lecture available. source R Markdown available Github.","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"outline","dir":"Articles","previous_headings":"","what":"Outline","title":"Applied Statistics for High-throughput Biology: Session 4","text":"Quantile Quantile (QQ)-plots Boxplots Scatterplots Volcano plots p-value histograms MA plots heatmaps Batch effects (Chapter 10)","code":""},{"path":[]},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"introduction","dir":"Articles","previous_headings":"Exploratory data analysis","what":"Introduction","title":"Applied Statistics for High-throughput Biology: Session 4","text":"“greatest value picture forces us notice never expected see.” - John W. Tukey Discover biases, systematic errors unexpected variability data Graphical approach detecting issues Represents first step data analysis guides hypothesis testing Opportunities discovery outliers","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"quantile-quantile-plots","dir":"Articles","previous_headings":"Exploratory data analysis","what":"Quantile Quantile Plots","title":"Applied Statistics for High-throughput Biology: Session 4","text":"Quantiles divide distribution equally sized bins Division 100 bins gives percentiles alternatively, quantiles two experimental distributions Given perfect fit, \\(x=y\\) Useful determining data distribution (normal, t, etc.)","code":""},{"path":[]},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"boxplots-about","dir":"Articles","previous_headings":"Exploratory data analysis","what":"Boxplots: About","title":"Applied Statistics for High-throughput Biology: Session 4","text":"Provide graph easy interpret data normally distributed appropriate choice explore income data, distribution highly skewed Particularly informative relation outliers range Possible compare multiple distributions side side","code":""},{"path":[]},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"scatterplots-and-correlation-about","dir":"Articles","previous_headings":"Exploratory data analysis","what":"Scatterplots And Correlation: About","title":"Applied Statistics for High-throughput Biology: Session 4","text":"two continuous variables, scatter plot calculation correlation useful Provides graphical numeric estimation relationships Quick easy plot() cor()","code":""},{"path":[]},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"exploratory-data-analysis-in-high-dimensions","dir":"Articles","previous_headings":"Exploratory data analysis","what":"Exploratory data analysis in high dimensions","title":"Applied Statistics for High-throughput Biology: Session 4","text":"","code":"library(GSE5859Subset) data(GSE5859Subset) ##this loads three tables c(class(geneExpression), class(sampleInfo)) #> [1] \"matrix\"     \"array\"      \"data.frame\" rbind(dim(geneExpression), dim(sampleInfo)) #>      [,1] [,2] #> [1,] 8793   24 #> [2,]   24    4 head(sampleInfo) #>     ethnicity       date         filename group #> 107       ASN 2005-06-23 GSM136508.CEL.gz     1 #> 122       ASN 2005-06-27 GSM136530.CEL.gz     1 #> 113       ASN 2005-06-27 GSM136517.CEL.gz     1 #> 163       ASN 2005-10-28 GSM136576.CEL.gz     1 #> 153       ASN 2005-10-07 GSM136566.CEL.gz     1 #> 161       ASN 2005-10-07 GSM136574.CEL.gz     1"},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"volcano-plots-setup","dir":"Articles","previous_headings":"Exploratory data analysis","what":"Volcano plots: Setup","title":"Applied Statistics for High-throughput Biology: Session 4","text":"T-test every row (gene) gene expression matrix: Note 8,793 tests done 0.01s","code":"library(genefilter) g <- factor(sampleInfo$group) system.time(results <- rowttests(geneExpression, g)) #>    user  system elapsed  #>   0.006   0.000   0.006 pvals <- results$p.value"},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"volcano-plots-example","dir":"Articles","previous_headings":"Exploratory data analysis","what":"Volcano plots: Example","title":"Applied Statistics for High-throughput Biology: Session 4","text":"","code":"par(mar = c(4, 4, 0, 0)) plot(results$dm,      -log10(results$p.value),      xlab = \"Effect size (difference in group means)\",      ylab = \"- log (base 10) p-values\") abline(h = -log10(0.05 / nrow(geneExpression)), col = \"red\") legend(\"bottomright\",        lty = 1,        col = \"red\",        legend = \"Bonferroni = 0.05\")"},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"volcano-plots-summary","dir":"Articles","previous_headings":"Exploratory data analysis","what":"Volcano plots: Summary","title":"Applied Statistics for High-throughput Biology: Session 4","text":"Many small p-values small effect size indicate low within-group variability Inspect asymmetry Can color points significance threshold","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"p-value-histograms-setup","dir":"Articles","previous_headings":"Exploratory data analysis","what":"P-value histograms: Setup","title":"Applied Statistics for High-throughput Biology: Session 4","text":"null hypotheses true, expect flat histogram p-values:","code":"m <- nrow(geneExpression) n <- ncol(geneExpression) set.seed(1) randomData <- matrix(rnorm(n * m), m, n) nullpvals <- rowttests(randomData, g)$p.value"},{"path":[]},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"p-value-histograms-example-2-permutation","dir":"Articles","previous_headings":"Exploratory data analysis","what":"P-value histograms: Example 2 (permutation)","title":"Applied Statistics for High-throughput Biology: Session 4","text":"Note permuting data doesn’t produce ideal null p-value histogram due batch effects:","code":"permg <- sample(g) permresults <- rowttests(geneExpression, permg) hist(permresults$p.value)"},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"p-value-histograms-summary","dir":"Articles","previous_headings":"Exploratory data analysis","what":"P-value histograms: Summary","title":"Applied Statistics for High-throughput Biology: Session 4","text":"Give quick look many significant p-values may can due batch effects family structure ComBat: corrects known batch effects linear model), sva: creates surrogate variables unknown batch effects, corrects structure permutation p-values correction using control (housekeeping) genes batchelor single-cell analysis ComBat sva available sva Bioconductor package","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"ma-plot","dir":"Articles","previous_headings":"Exploratory data analysis","what":"MA plot","title":"Applied Statistics for High-throughput Biology: Session 4","text":"just scatterplot rotated 45\\(^o\\)","code":"rafalib::mypar(1, 2) pseudo <- apply(geneExpression, 1, median) plot(geneExpression[, 1], pseudo) plot((geneExpression[, 1] + pseudo) / 2, (geneExpression[, 1] - pseudo))"},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"ma-plot-summary","dir":"Articles","previous_headings":"Exploratory data analysis","what":"MA plot: Summary","title":"Applied Statistics for High-throughput Biology: Session 4","text":"useful quality control high-dimensional data plot data values sample another sample median “pseudosample” adds smoothing line highlight departures horizontal line plots “cloud” rather many data points","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"heatmaps","dir":"Articles","previous_headings":"Exploratory data analysis","what":"Heatmaps","title":"Applied Statistics for High-throughput Biology: Session 4","text":"ComplexHeatmap package best 2023: large datasets, interactive heatmaps, simple defaults many customizations possible","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"heatmaps-summary","dir":"Articles","previous_headings":"Exploratory data analysis","what":"Heatmaps: Summary","title":"Applied Statistics for High-throughput Biology: Session 4","text":"probably detailed thousands rows can show co-expressed genes, groups samples","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"colors","dir":"Articles","previous_headings":"Exploratory data analysis","what":"Colors","title":"Applied Statistics for High-throughput Biology: Session 4","text":"sequential: shows gradient diverging: goes two directions center qualitative: categorical variables Keep color blindness mind (10% men)","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"colors-contd","dir":"Articles","previous_headings":"Exploratory data analysis","what":"Colors (cont’d)","title":"Applied Statistics for High-throughput Biology: Session 4","text":"Combination RColorBrewer package colorRampPalette() can create anything want","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"plots-to-avoid","dir":"Articles","previous_headings":"Exploratory data analysis","what":"Plots To Avoid","title":"Applied Statistics for High-throughput Biology: Session 4","text":"“Pie charts bad way displaying information.” - R Help Avoid pie charts Avoid doughnut charts Avoid pseudo 3D Use color judiciously","code":""},{"path":[]},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"pervasiveness-of-batch-effects","dir":"Articles","previous_headings":"Batch effects","what":"Pervasiveness of batch Effects","title":"Applied Statistics for High-throughput Biology: Session 4","text":"pervasive genomics (e.g. Leek et al. Nat Rev Genet. 2010 Oct;11(10):733-9.) affect DNA RNA sequencing, proteomics, imaging, microarray… can’t get rid can make sure confounded experiment","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"batch-effects---an-example","dir":"Articles","previous_headings":"Batch effects","what":"Batch Effects - an example","title":"Applied Statistics for High-throughput Biology: Session 4","text":"Nat Genet. 2007 Feb;39(2):226-31. Epub 2007 Jan 7. “results show specific genetic variation among populations contributes appreciably differences gene expression phenotypes.” Note: ExpressionSet object obsolete, use SummarizedExperiment now","code":"library(Biobase) library(genefilter) library(GSE5859) ## BiocInstaller::biocLite(\"genomicsclass/GSE5859\") data(GSE5859) geneExpression = exprs(e) sampleInfo = pData(e)"},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"date-of-processing-as-a-proxy-for-batch","dir":"Articles","previous_headings":"Batch effects","what":"Date of processing as a proxy for batch","title":"Applied Statistics for High-throughput Biology: Session 4","text":"Sample metadata included date processing:","code":"head(table(sampleInfo$date)) #>  #> 2002-10-31 2002-11-15 2002-11-19 2002-11-21 2002-11-22 2002-11-27  #>          2          2          2          5          4          2 year <-  as.integer(format(sampleInfo$date, \"%y\")) year <- year - min(year) month = as.integer(format(sampleInfo$date, \"%m\")) + 12 * year table(year, sampleInfo$ethnicity) #>      #> year ASN CEU HAN #>    0   0  32   0 #>    1   0  54   0 #>    2   0  13   0 #>    3  80   3   0 #>    4   2   0  24"},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"visualizing-batch-effects-by-pca","dir":"Articles","previous_headings":"Batch effects","what":"Visualizing batch effects by PCA","title":"Applied Statistics for High-throughput Biology: Session 4","text":"","code":"pc <- prcomp(t(geneExpression), scale. = TRUE) boxplot(     pc$x[, 1] ~ month,     varwidth = TRUE,     notch = TRUE,     main = \"PC1 scores vs. month\",     xlab = \"Month\",     ylab = \"PC1\" )"},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"visualizing-batch-effects-by-mds","dir":"Articles","previous_headings":"Batch effects","what":"Visualizing batch effects by MDS","title":"Applied Statistics for High-throughput Biology: Session 4","text":"starting point color palette:  Interpolate one color per month quantitative palette:","code":"RColorBrewer::display.brewer.all(n = 3, colorblindFriendly = TRUE) col3 <- c(RColorBrewer::brewer.pal(n = 3, \"Greys\")[2:3], \"black\") MYcols <- colorRampPalette(col3, space = \"Lab\")(length(unique(month)))"},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"visualizing-batch-effects-by-mds-1","dir":"Articles","previous_headings":"Batch effects","what":"Visualizing batch effects by MDS","title":"Applied Statistics for High-throughput Biology: Session 4","text":"","code":"d <- as.dist(1 - cor(geneExpression)) mds <- cmdscale(d) plot(mds, col = MYcols[as.integer(factor(month))],      main = \"MDS shaded by month\")"},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"the-batch-effects-impact-clustering","dir":"Articles","previous_headings":"Batch effects","what":"The batch effects impact clustering","title":"Applied Statistics for High-throughput Biology: Session 4","text":"","code":"hcclass <- cutree(hclust(d), k = 5) table(hcclass, year) #>        year #> hcclass  0  1  2  3  4 #>       1  0  2  8  1  0 #>       2 25 43  0  2  0 #>       3  6  0  0  0  0 #>       4  1  7  0  0  0 #>       5  0  2  5 80 26"},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"approaches-to-correcting-for-batch-effects","dir":"Articles","previous_headings":"Batch effects","what":"Approaches to correcting for batch effects","title":"Applied Statistics for High-throughput Biology: Session 4","text":"experience, best choice machine learning applications Rescale observations (cells) mean, variance batch maintains sparsity (ie zeros remain zeros) batchelor::rescaleBatches() use batches known. Fits linear model use residuals assumes composition cells across batches limma::removeBatchEffect(), sva::comBat(), batchelor::regressBatches() can used batches unknown “Surrogate Variables Analysis” implemented sva package developed specifically single-cell RNA-seq assumption composition cells across batches, still assumes meaningful biological differences exist batches batchelor::fastMNN()","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"batch-effects---summary","dir":"Articles","previous_headings":"Batch effects","what":"Batch Effects - summary","title":"Applied Statistics for High-throughput Biology: Session 4","text":"confounded treatment outcome interest, nothing can help randomization samples batches study design protects keep track anything might cause batch effect post-hoc analysis include control samples batch tend affect many measurements little bit","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"exercises","dir":"Articles","previous_headings":"Batch effects","what":"Exercises","title":"Applied Statistics for High-throughput Biology: Session 4","text":"OSCA Multi-sample Chapter 1: Correcting batch effects","code":""},{"path":"http://waldronlab.io/AppStatBio/articles/day4_batcheffects-vis.html","id":"links","dir":"Articles","previous_headings":"Batch effects","what":"Links","title":"Applied Statistics for High-throughput Biology: Session 4","text":"built html version lecture available. source R Markdown available Github.","code":""},{"path":"http://waldronlab.io/AppStatBio/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Levi Waldron. Author, maintainer.","code":""},{"path":"http://waldronlab.io/AppStatBio/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Waldron L (2023). AppStatBio: Course Materials Applied Statistics High-throughput Biology. http://waldronlab.io/AppStatBio/, https://github.com/waldronlab/AppStatBio.","code":"@Manual{,   title = {AppStatBio: Course Materials for Applied Statistics for High-throughput Biology},   author = {Levi Waldron},   year = {2023},   note = {http://waldronlab.io/AppStatBio/, https://github.com/waldronlab/AppStatBio}, }"},{"path":[]},{"path":"http://waldronlab.io/AppStatBio/index.html","id":"instructor","dir":"","previous_headings":"","what":"Instructor","title":"Course Materials for Applied Statistics for High-throughput Biology","text":"Levi Waldron, PhD Associate Professor Biostatistics City University New York School Graduate Public Health Health Policy New York, NY, U.S.. Email: lwaldron.research@gmail.com","code":""},{"path":"http://waldronlab.io/AppStatBio/index.html","id":"summary","dir":"","previous_headings":"","what":"Summary","title":"Course Materials for Applied Statistics for High-throughput Biology","text":"course provide biologists bioinformaticians practical statistical data analysis skills perform rigorous analysis high-throughput biological data. course assumes familiarity genomics R programming, assume prior statistical training. covers statistical concepts necessary design experiments analyze high-dimensional data generated genomic technologies, including: exploratory data analysis, linear modeling, analysis categorical variables, principal components analysis, batch effects.","code":""},{"path":"http://waldronlab.io/AppStatBio/index.html","id":"textbooks","dir":"","previous_headings":"","what":"Textbooks","title":"Course Materials for Applied Statistics for High-throughput Biology","text":"Source repository Secondary: Modern Statistics Modern Biology Holmes Huber Lab materials: Orchestrating Single-Cell Analysis Bioconductor (OSCA) Amezquita, Lun, Hicks, Gottardo, O’Callaghan","code":""},{"path":"http://waldronlab.io/AppStatBio/index.html","id":"labs","dir":"","previous_headings":"","what":"Labs","title":"Course Materials for Applied Statistics for High-throughput Biology","text":"day include hands-lab session Orchestrating Single-Cell Analysis Bioconductor, students attempt full.","code":""},{"path":"http://waldronlab.io/AppStatBio/index.html","id":"session-detail-by-day","dir":"","previous_headings":"","what":"Session detail by day","title":"Course Materials for Applied Statistics for High-throughput Biology","text":"Lecture materials available HTML format https://waldronlab.io/AppStatBio/. Introduction random variables distributions hypothesis testing one two samples (t-test, Wilcoxon test, etc) Dimensionality reduction Distances high dimensions Principal Components Analysis Singular Value Decomposition Multidimensional Scaling t-SNE UMAP Linear Modeling Multiple linear regression Model formulae Generalized Linear Models Multiple Hypothesis Testing Exploratory Data Analysis Batch Effects Plots exploratory data analysis batch effects","code":""}]
